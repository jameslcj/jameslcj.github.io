{"tags":[{"name":"JavaScript","permalink":"http://blog.hellolc.com/tags/JavaScript/","url":"/async/tags/JavaScript.json","count":6},{"name":"Jquery","permalink":"http://blog.hellolc.com/tags/Jquery/","url":"/async/tags/Jquery.json","count":1}],"categories":[],"url":"/async/posts/2017/01/11/Jquery源码心得.json","date":1484134697000,"path":{"year":2017,"month":1,"day":11,"name":"Jquery源码心得"},"title":"jquery源码心得","permalink":"http://blog.hellolc.com/2017/01/11/Jquery源码心得/","content":"<h1 id=\"阅读jquery源码心得\"><a href=\"#阅读jquery源码心得\" class=\"headerlink\" title=\"阅读jquery源码心得\"></a>阅读jquery源码心得</h1><ul>\n<li>闭包参数传递window, 是为了寻找window时, 不用寻找到外层, 提高效率, 也为压缩代码提供了方便</li>\n<li>闭包声明undefined, 但不赋值, 就是让underfined == ‘underfined’ 防止ie9一下的浏览器 修改其值</li>\n<li>jquery = function(selector,…) {return new jquery.property.init()} 这样做是做了 我们平时$()时 就能执行init里的方法; 不用每次都要先调用init; 如何实现? jquery.property.init.property = jquery.property; 这样init 不仅有自身方法也有jquery的所有方法</li>\n<li>null 只与 null和undefined 相等, 其他都是false</li>\n<li>typeof Nan == ‘number’ 所以要用isNan 和 isFinite 来判断是不是数字</li>\n<li>判断类型建议使用 [].toString.call(new Date)  {}.toString.call(new Date) 获取更新详细的结果</li>\n<li>obj.constructor.prototype.hasOwnProperty(‘isPrototypeOf’) 对象独有的属性</li>\n</ul>\n<h3 id=\"mouseover-mousein-结构嵌套时冒泡解决方法\"><a href=\"#mouseover-mousein-结构嵌套时冒泡解决方法\" class=\"headerlink\" title=\"mouseover mousein 结构嵌套时冒泡解决方法\"></a>mouseover mousein 结构嵌套时冒泡解决方法</h3><ul>\n<li>mouseover mousein 在结构嵌套的时候会有冒泡传递事件影响有些需求事件, 可以换成mouseleave mouseenter</li>\n<li>其他解决方法<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div></pre></td><td class=\"code\"><pre><div class=\"line\">//解决方法</div><div class=\"line\">&lt;script&gt;</div><div class=\"line\">var oDiv1 = document.getElementById(&apos;div1&apos;);</div><div class=\"line\">var oDiv2 = document.getElementById(&apos;div2&apos;);</div><div class=\"line\">var oSpan1 = document.getElementById(&apos;span1&apos;);</div><div class=\"line\">oDiv1.onmouseover = function(ev)&#123;</div><div class=\"line\">\tvar ev = ev || window.event;</div><div class=\"line\">\tvar a = this;</div><div class=\"line\">\tvar b = ev.relatedTarget;</div><div class=\"line\">\tif( !elContains(a, b) &amp;&amp; a!=b )&#123;</div><div class=\"line\">\t\toSpan1.innerHTML += &apos;1&apos;;</div><div class=\"line\">\t&#125;</div><div class=\"line\">&#125;;</div><div class=\"line\">oDiv1.onmouseout = function(ev)&#123;</div><div class=\"line\">\tvar ev = ev || window.event;</div><div class=\"line\">\tvar a = this;</div><div class=\"line\">\tvar b = ev.relatedTarget;</div><div class=\"line\">\tif( !elContains(a, b) &amp;&amp; a!=b )&#123;</div><div class=\"line\">\t\toSpan1.innerHTML += &apos;2&apos;;</div><div class=\"line\">\t&#125;</div><div class=\"line\">&#125;;</div><div class=\"line\">function elContains(a, b)&#123;  //两个元素是否是嵌套关系</div><div class=\"line\">\treturn a.contains ? a != b &amp;&amp; a.contains(b) : !!(a.compareDocumentPosition(b) &amp; 16);</div><div class=\"line\">&#125;</div><div class=\"line\">&lt;/script&gt;</div><div class=\"line\">&lt;body&gt;</div><div class=\"line\">&lt;style&gt;</div><div class=\"line\">#div1&#123; width:200px; height:200px; background:red;&#125;</div><div class=\"line\">#div2&#123; width:100px; height:100px; background:yellow;&#125;</div><div class=\"line\">&lt;/style&gt;</div><div class=\"line\"></div><div class=\"line\">&lt;div id=&quot;div1&quot;&gt;</div><div class=\"line\">\t&lt;div id=&quot;div2&quot;&gt;&lt;/div&gt;</div><div class=\"line\">&lt;/div&gt;</div><div class=\"line\">&lt;span id=&quot;span1&quot;&gt;11111111111&lt;/span&gt;</div><div class=\"line\">&lt;/body&gt;</div></pre></td></tr></table></figure>\n</li>\n</ul>\n<h3 id=\"trigger-与-triggerHandler的区别\"><a href=\"#trigger-与-triggerHandler的区别\" class=\"headerlink\" title=\"trigger() 与 triggerHandler的区别\"></a>trigger() 与 triggerHandler的区别</h3><ul>\n<li>trigger 会触发对应事件的回调函数, 并且触发事件的默认行为(比如focus 光标会获取焦点)</li>\n<li>triggerHandler 会触发对应事件的回调函数, 但不会触发事件的默认行为<h3 id=\"prop-与-attr的区别\"><a href=\"#prop-与-attr的区别\" class=\"headerlink\" title=\"$().prop 与 $().attr的区别\"></a><code>$().prop</code> 与 <code>$().attr</code>的区别</h3></li>\n<li><code>$(&quot;#id&quot;).prop</code> 实现的原理是<ul>\n<li>设置值时: <code>document.getElementById(&#39;id&#39;)[&#39;name&#39;] = &#39;name&#39;</code></li>\n<li>获取值时: <code>document.getElementById(&#39;id&#39;)[&#39;name&#39;]</code></li>\n</ul>\n</li>\n<li><code>$(&quot;#id&quot;).attr</code> 实现的原理是<ul>\n<li>设置值时: <code>document.getElementById(&#39;id&#39;).setAttribute = &#39;name&#39;</code></li>\n<li>获取值时: <code>document.getElementById(&#39;id&#39;).getAttribute</code></li>\n</ul>\n</li>\n<li>当对document等对象(没有setAttrite方法), 建议使用prop(jquery做了兼容)</li>\n<li>当获取自定义或者设置自定义属性时, prop在某些浏览器上无法实现</li>\n<li>removeProp在某些浏览器上无法删除原生属性</li>\n</ul>\n<h3 id=\"浏览器内存泄漏\"><a href=\"#浏览器内存泄漏\" class=\"headerlink\" title=\"浏览器内存泄漏\"></a>浏览器内存泄漏</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">var div1 = document.getElementById(&apos;div&apos;)[0];</div><div class=\"line\">var div2 = document.getElementById(&apos;div&apos;)[1];</div><div class=\"line\">div1.name = div2;</div><div class=\"line\">div2.name = div1;</div></pre></td></tr></table></figure>\n<h3 id=\"的-attr-prop-data3个方法的区别\"><a href=\"#的-attr-prop-data3个方法的区别\" class=\"headerlink\" title=\"$的 attr, prop, data3个方法的区别\"></a>$的 attr, prop, data3个方法的区别</h3><ul>\n<li>data不会有浏览器内存泄漏, 其他2个会有</li>\n<li>data适合挂载大量数据</li>\n<li>data是利用一个中间件将对象和属性联系起来的, 不是直接将属性挂载在对象上, 这样就避免了内存泄漏, 和挂载大量数据时影响效率</li>\n</ul>\n"}