{"tags":[{"name":"JavaScript","permalink":"wjcun.com/tags/JavaScript/","url":"/async/tags/JavaScript.json","count":7}],"categories":[],"url":"/async/posts/2017/03/02/Backbone.json","date":1488460891000,"path":{"year":2017,"month":3,"day":2,"name":"Backbone"},"title":"Backbone","permalink":"wjcun.com/2017/03/02/Backbone/","content":"<h3 id=\"backbone依赖\"><a href=\"#backbone依赖\" class=\"headerlink\" title=\"backbone依赖\"></a>backbone依赖</h3><ul>\n<li>依赖<code>jquery</code>库 进行dom操作</li>\n<li>依赖<code>underscore</code> 进行数据存储<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;script type=&quot;text/javascript&quot; src=&quot;jquery-2.0.3.min.js&quot;&gt;&lt;/script&gt;</span><br><span class=\"line\">&lt;script type=&quot;text/javascript&quot; src=&quot;underscore-min.js&quot;&gt;&lt;/script&gt;</span><br><span class=\"line\">&lt;script type=&quot;text/javascript&quot; src=&quot;backbone-min.js&quot;&gt;&lt;/script&gt;</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<h3 id=\"model-与-collection的区别\"><a href=\"#model-与-collection的区别\" class=\"headerlink\" title=\"model 与 collection的区别\"></a><code>model</code> 与 <code>collection</code>的区别</h3><ul>\n<li><code>collection</code>是多条<code>model</code>对象的集合<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">var collect = new Backbone.Collection();</span><br><span class=\"line\">    var model = new Backbone.Model();</span><br><span class=\"line\">    model.set(&apos;name&apos;, &apos;bbb&apos;)</span><br><span class=\"line\">    model.set(&#123;&apos;age&apos;: 18&#125;)</span><br><span class=\"line\">    collect.add(model)</span><br><span class=\"line\">    alert(JSON.stringify(collect))</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<h3 id=\"model的扩展\"><a href=\"#model的扩展\" class=\"headerlink\" title=\"model的扩展\"></a>model的扩展</h3><ul>\n<li>第一个对象是扩展对象方法</li>\n<li>第二个对象是扩展静态方法<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">var M = Backbone.Model.extend(&#123;</span><br><span class=\"line\">        aaa: function() &#123;</span><br><span class=\"line\">            alert(&apos;aaa&apos;)</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;, &#123;</span><br><span class=\"line\">        bbb: function() &#123;</span><br><span class=\"line\">            alert(&apos;bbb&apos;)</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">    M.bbb();</span><br><span class=\"line\">    var model = new M</span><br><span class=\"line\">    model.aaa();</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<h3 id=\"初始化默认值\"><a href=\"#初始化默认值\" class=\"headerlink\" title=\"初始化默认值\"></a>初始化默认值</h3><ul>\n<li>defaults 默认参数</li>\n<li>initialize 默认方法<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">var M = Backbone.Model.extend(&#123;</span><br><span class=\"line\">        defaults: &#123;</span><br><span class=\"line\">            name: &apos;lc&apos;</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        initialize: function() &#123;</span><br><span class=\"line\">        //当有变化时触发 change后面可以添加参数 指定某个参数变化 触发 如change:name</span><br><span class=\"line\">            this.on(&apos;change&apos;, function() &#123;</span><br><span class=\"line\">                alert(&apos;changed&apos;)</span><br><span class=\"line\">            &#125;)</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">    var model = new M();</span><br><span class=\"line\">    alert(model.get(&apos;name&apos;))</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<h3 id=\"继承\"><a href=\"#继承\" class=\"headerlink\" title=\"继承\"></a>继承</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">var M = Backbone.Model.extend(&#123;</span><br><span class=\"line\">        defaults: &#123;</span><br><span class=\"line\">            name: &apos;lc&apos;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">    var childModel = M.extend();</span><br><span class=\"line\">    var model = new childModel();</span><br><span class=\"line\">    alert(model.get(&apos;name&apos;))</span><br></pre></td></tr></table></figure>\n<h3 id=\"与view结合\"><a href=\"#与view结合\" class=\"headerlink\" title=\"与view结合\"></a>与view结合</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">var M = Backbone.Model.extend(&#123;</span><br><span class=\"line\">        defaults: &#123;</span><br><span class=\"line\">            name: &apos;lc&apos;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">    var V = Backbone.View.extend(&#123;</span><br><span class=\"line\">        initialize: function() &#123;</span><br><span class=\"line\">            this.listenTo(this.model, &apos;change&apos;, this.show);</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        show: function(model) &#123;</span><br><span class=\"line\">            $(&apos;body&apos;).append(&apos;&lt;div&gt;&apos; + model.get(&apos;name&apos;) + &apos;&lt;/div&gt;&apos;)</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">    var m = new M();</span><br><span class=\"line\">    var view  = new V(&#123;model: m&#125;)</span><br><span class=\"line\">    setTimeout(function() &#123;</span><br><span class=\"line\">        m.set(&#123;name: &apos;ll&apos;&#125;)</span><br><span class=\"line\">    &#125;, 1000)</span><br></pre></td></tr></table></figure>\n<h3 id=\"save-与-sync联系\"><a href=\"#save-与-sync联系\" class=\"headerlink\" title=\"save 与 sync联系\"></a>save 与 sync联系</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Backbone.sync = function(method, model) &#123;</span><br><span class=\"line\">        alert(method + &apos;:&apos; + JSON.stringify(model))</span><br><span class=\"line\">        //将method方法改成update</span><br><span class=\"line\">        model.id = 1</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    var M = Backbone.Model.extend(&#123;</span><br><span class=\"line\">        defaults: &#123;</span><br><span class=\"line\">            name: &apos;lc&apos;</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        url: &apos;/url&apos;</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">    var model = new M()</span><br><span class=\"line\">    model.save()</span><br><span class=\"line\">    model.save(&#123;name: &apos;ll&apos;&#125;)</span><br></pre></td></tr></table></figure>\n<h3 id=\"fetch-获取服务器资源\"><a href=\"#fetch-获取服务器资源\" class=\"headerlink\" title=\"fetch 获取服务器资源\"></a>fetch 获取服务器资源</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Backbone.sync = function(method, model) &#123;</span><br><span class=\"line\">        alert(method + &apos;:&apos; + JSON.stringify(model))</span><br><span class=\"line\">        //将method方法改成update</span><br><span class=\"line\">        // model.id = 1</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    var C = Backbone.Collection.extend(&#123;</span><br><span class=\"line\">        initialize: function() &#123;</span><br><span class=\"line\">            this.on(&apos;reset&apos;, function() &#123;</span><br><span class=\"line\">                alert(123)</span><br><span class=\"line\">            &#125;)</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        url: &apos;http://www.baidu.com&apos;</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">    var model = new C()</span><br><span class=\"line\">    model.fetch()</span><br></pre></td></tr></table></figure>\n<h3 id=\"Router\"><a href=\"#Router\" class=\"headerlink\" title=\"Router\"></a>Router</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">var m = Backbone.Router.extend(&#123;</span><br><span class=\"line\">        routes: &#123;</span><br><span class=\"line\">            &apos;index&apos;: &apos;index&apos;,</span><br><span class=\"line\">            &apos;getData/:id&apos;: &apos;getData&apos;,</span><br><span class=\"line\">            &apos;setData/:id/:data&apos;: &apos;setData&apos;</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        index: function() &#123;</span><br><span class=\"line\">            alert(&apos;index&apos;)</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        getData(id) &#123;</span><br><span class=\"line\">            alert(id)</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        setData(id, data) &#123;</span><br><span class=\"line\">            alert(id + &apos;:&apos; + data )</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">    var model = new m();</span><br><span class=\"line\">    Backbone.history.start()</span><br></pre></td></tr></table></figure>\n<h3 id=\"事件委托\"><a href=\"#事件委托\" class=\"headerlink\" title=\"事件委托\"></a>事件委托</h3><ul>\n<li>对dom操作<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">var V = Backbone.View.extend(&#123;</span><br><span class=\"line\">        //模板</span><br><span class=\"line\">        el: $(&apos;body&apos;),</span><br><span class=\"line\">        events: &#123;</span><br><span class=\"line\">            //监听事件 dom对象 回调方法</span><br><span class=\"line\">            &apos;click li&apos;: &apos;test&apos;</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        test: function() &#123;</span><br><span class=\"line\">            alert(&apos;aaa&apos;)</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">    var view = new V</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<h3 id=\"模板\"><a href=\"#模板\" class=\"headerlink\" title=\"模板\"></a>模板</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;script type=&quot;text/template&quot; id=&quot;template&quot;&gt;</span><br><span class=\"line\">        &lt;% for (var i = 0; i &lt; 5; i ++) &#123;%&gt;</span><br><span class=\"line\">            &lt;div&gt;&lt;%= name %&gt;&lt;/div&gt;</span><br><span class=\"line\">        &lt;% &#125; %&gt;</span><br><span class=\"line\">    &lt;/script&gt;</span><br><span class=\"line\">    </span><br><span class=\"line\">var M = Backbone.Model.extend(&#123;</span><br><span class=\"line\">        defaults: &#123;</span><br><span class=\"line\">            name: &apos;lc&apos;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">    var V = Backbone.View.extend(&#123;</span><br><span class=\"line\">        initialize: function() &#123;</span><br><span class=\"line\">            this.listenTo(this.model, &apos;change&apos;, this.show);</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        show: function(model) &#123;</span><br><span class=\"line\">            //将数据转成json 传递给模板生成</span><br><span class=\"line\">            $(&apos;body&apos;).append(this.template(this.model.toJSON()))</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        // 拿到模板 并获取数据填充</span><br><span class=\"line\">        template: _.template($(&quot;#template&quot;).html())</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">    var m = new M();</span><br><span class=\"line\">    var view  = new V(&#123;model: m&#125;)</span><br><span class=\"line\">    setTimeout(function() &#123;</span><br><span class=\"line\">        m.set(&#123;name: &apos;ll&apos;&#125;)</span><br><span class=\"line\">    &#125;, 1000)</span><br></pre></td></tr></table></figure>\n"}