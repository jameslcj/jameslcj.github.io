{"tags":[{"name":"html5","permalink":"http://blog.hellolc.com/tags/html5/","url":"/async/tags/html5.json","count":1}],"categories":[],"url":"/async/posts/2017/03/02/canvas.json","date":1488461162000,"path":{"year":2017,"month":3,"day":2,"name":"canvas"},"title":"canvas","permalink":"http://blog.hellolc.com/2017/03/02/canvas/","content":"<h3 id=\"创建canvas\"><a href=\"#创建canvas\" class=\"headerlink\" title=\"创建canvas\"></a>创建canvas</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">//创建canvas对象</span><br><span class=\"line\">var canvasObj = document.getElementById(&apos;canvas&apos;);</span><br><span class=\"line\">//获取画笔</span><br><span class=\"line\">var canvas = canvasObj.getContext(&apos;2d&apos;);</span><br></pre></td></tr></table></figure>\n<h3 id=\"fillRect-left-top-width-height-填充的矩形\"><a href=\"#fillRect-left-top-width-height-填充的矩形\" class=\"headerlink\" title=\"fillRect(left, top, width, height) 填充的矩形\"></a>fillRect(left, top, width, height) 填充的矩形</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">canvas.fillStyle = &apos;blue&apos;;</span><br><span class=\"line\">canvas.fillRect(50, 50, 100, 100);</span><br><span class=\"line\"></span><br><span class=\"line\">//等价于</span><br><span class=\"line\">canvas.rect(50, 50, 100, 100)</span><br><span class=\"line\">canvas.fill();</span><br></pre></td></tr></table></figure>\n<ul>\n<li>fillStyle 填充颜色</li>\n</ul>\n<h3 id=\"strokeRect-l-t-w-h-只有边框的矩形\"><a href=\"#strokeRect-l-t-w-h-只有边框的矩形\" class=\"headerlink\" title=\"strokeRect(l, t, w, h) 只有边框的矩形\"></a>strokeRect(l, t, w, h) 只有边框的矩形</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">canvas.lineJoin = &apos;round&apos;;</span><br><span class=\"line\">canvas.lineWidth = 10</span><br><span class=\"line\">canvas.strokeStyle = &apos;red&apos;</span><br><span class=\"line\">canvas.strokeRect(150.5,150.5, 100, 100);</span><br></pre></td></tr></table></figure>\n<ul>\n<li>lineJoin 边框弧度 round(圆角) bevel(斜角)</li>\n<li>lineCap 线条边框弧度</li>\n<li>lineWidth 线宽</li>\n<li>strokeStyle 线条颜色</li>\n<li>建议left和top尽量使用0.5, 不然会多一个像素</li>\n</ul>\n<h3 id=\"clearRect-l-t-w-h-清除画布\"><a href=\"#clearRect-l-t-w-h-清除画布\" class=\"headerlink\" title=\"clearRect(l, t, w, h) 清除画布\"></a>clearRect(l, t, w, h) 清除画布</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">canvas.clearRect(0, 0, 300, 300);</span><br></pre></td></tr></table></figure>\n<h3 id=\"画直线\"><a href=\"#画直线\" class=\"headerlink\" title=\"画直线\"></a>画直线</h3><ul>\n<li>moveTo(x, y) 移动画笔到抹点</li>\n<li>lineTo(x, y) 定一个点</li>\n<li>stroke() 连接线</li>\n<li>fill 填充颜色<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">canvas.moveTo(100, 100);</span><br><span class=\"line\">canvas.lineWidth = 5;</span><br><span class=\"line\">canvas.lineTo(150, 200);</span><br><span class=\"line\">canvas.lineTo(200, 200);</span><br><span class=\"line\">canvas.closePath();</span><br><span class=\"line\">canvas.stroke();</span><br><span class=\"line\">canvas.beginPath();</span><br><span class=\"line\">canvas.moveTo(200, 100);</span><br><span class=\"line\">canvas.lineTo(300, 200);</span><br><span class=\"line\">canvas.lineTo(300, 400);</span><br><span class=\"line\">canvas.stroke();</span><br><span class=\"line\">canvas.fillStyle = &apos;green&apos;;</span><br><span class=\"line\">canvas.fill()</span><br><span class=\"line\">canvas.closePath();</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<h3 id=\"画圆\"><a href=\"#画圆\" class=\"headerlink\" title=\"画圆\"></a>画圆</h3><ul>\n<li>arc(x, y, r, 起始弧度, 结束弧度, 旋转方向)<ul>\n<li>弧度 = 角度 * Math.PI / 180</li>\n<li>旋转方向: true为逆时针, false为瞬时间</li>\n<li>stroke fill closePath等 这些和画直线功能一样<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">canvas.arc(200, 200, 100, 0, 90 * Math.PI / 180, true);</span><br><span class=\"line\">    canvas.stroke();</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"画弧线\"><a href=\"#画弧线\" class=\"headerlink\" title=\"画弧线\"></a>画弧线</h3><ul>\n<li><p>arcTo(x1, y1, x2, y2, r)</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">canvas.moveTo(100, 200)</span><br><span class=\"line\">    canvas.arcTo(100, 100, 200, 100, 50)</span><br><span class=\"line\">    canvas.stroke()</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>quadraticCurveTo(x1, y1, x2, y2, r)</p>\n<ul>\n<li>弧度会趋向moveTo那个点<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">//趋向点</span><br><span class=\"line\">canvas.moveTo(100, 200)</span><br><span class=\"line\">canvas.quadraticCurveTo(100, 100, 200, 200, 100)</span><br><span class=\"line\">canvas.stroke()</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n</li>\n<li><p>bezierCurveTo(趋向点x1, 趋向点y1, 趋向点x2, 趋向点y2, 终点x, 终点y);</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">//起始点</span><br><span class=\"line\">canvas.moveTo(100, 200)</span><br><span class=\"line\">canvas.bezierCurveTo(100, 100, 200, 200, 200, 100)</span><br><span class=\"line\">canvas.stroke()</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<h3 id=\"beginPath-与-endPath\"><a href=\"#beginPath-与-endPath\" class=\"headerlink\" title=\"beginPath 与 endPath\"></a>beginPath 与 endPath</h3><ul>\n<li>beginPath() 开始画新线</li>\n<li>closePath() 闭合线</li>\n<li>beginPath和closePath是相对应 相应的作用就会在这闭合区间里生效</li>\n</ul>\n<h3 id=\"save-与-restore\"><a href=\"#save-与-restore\" class=\"headerlink\" title=\"save 与 restore\"></a>save 与 restore</h3><ul>\n<li>声明的fill填充颜色, lineWidth线条宽度等其他属性 只会在这个范围内生效<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">var canvasObj = document.getElementById(&apos;canvas&apos;);</span><br><span class=\"line\">    var canvas = canvasObj.getContext(&apos;2d&apos;);</span><br><span class=\"line\">    canvas.save();</span><br><span class=\"line\">    canvas.fillStyle = &apos;blue&apos;;</span><br><span class=\"line\">    canvas.fillRect(50,50, 100, 100);</span><br><span class=\"line\">    canvas.lineJoin = &apos;round&apos;;</span><br><span class=\"line\">    canvas.lineWidth = 10;</span><br><span class=\"line\">    canvas.strokeStyle = &apos;red&apos;;</span><br><span class=\"line\">    canvas.strokeRect(150.5,150.5, 100, 100);</span><br><span class=\"line\">    </span><br><span class=\"line\">    canvas.moveTo(100, 100);</span><br><span class=\"line\">    canvas.lineWidth = 5;</span><br><span class=\"line\">    canvas.lineTo(150, 200);</span><br><span class=\"line\">    canvas.lineTo(200, 200);</span><br><span class=\"line\">    canvas.closePath();</span><br><span class=\"line\">    canvas.stroke();</span><br><span class=\"line\">    canvas.restore()</span><br><span class=\"line\">    canvas.beginPath();</span><br><span class=\"line\">    canvas.moveTo(200, 100);</span><br><span class=\"line\">    canvas.lineTo(300, 200);</span><br><span class=\"line\">    canvas.lineTo(300, 400);</span><br><span class=\"line\">    canvas.stroke();</span><br><span class=\"line\">    canvas.fill()</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<h3 id=\"变形\"><a href=\"#变形\" class=\"headerlink\" title=\"变形\"></a>变形</h3><ul>\n<li><p>traslate(x, y)</p>\n<ul>\n<li>改变变化相对位置(默认是0,0 点)</li>\n<li>如果需要按图形中心点旋转, 需要使用save, restore, translate, rotate配合使用<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">canvas.save()</span><br><span class=\"line\">canvas.clearRect(0, 0, canvasObj.width, canvasObj.height);</span><br><span class=\"line\">canvas.rotate(num * Math.PI / 180);</span><br><span class=\"line\">// canvas.scale(start / 50, start / 50);</span><br><span class=\"line\">canvas.translate(-50, -50)</span><br><span class=\"line\">canvas.fillRect(0, 0, 100, 100);</span><br><span class=\"line\">canvas.restore()</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n</li>\n<li><p>rotate(arc)</p>\n<ul>\n<li>以弧度为单位旋转</li>\n<li>以左上角基准旋转</li>\n<li>数值会累加 速度会越来越快 所以用 save和restroe抱起来就可以解决这个问题</li>\n</ul>\n</li>\n<li>scale(x, y)<ul>\n<li>等比缩放</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"加载图片\"><a href=\"#加载图片\" class=\"headerlink\" title=\"加载图片\"></a>加载图片</h3><ul>\n<li>drwaImage(source, x, y, w, h)</li>\n<li>createPattern(source, 平铺方式)<ul>\n<li>平铺方式: repeat, repeat-x, repeat-y, no-repeat<h3 id=\"渐变\"><a href=\"#渐变\" class=\"headerlink\" title=\"渐变\"></a>渐变</h3></li>\n</ul>\n</li>\n<li>createLinearGradient(sx, sy, ex, ey)</li>\n<li><p>addColorStop(0-1, ‘颜色’)</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">var obj = canvas.createLinearGradient(100, 100, 100, 200);</span><br><span class=\"line\">obj.addColorStop(0, &apos;red&apos;);</span><br><span class=\"line\">obj.addColorStop(1, &apos;blue&apos;);</span><br><span class=\"line\">canvas.fillStyle = obj ;</span><br><span class=\"line\">canvas.fillRect(100, 100, 100, 200);</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>createRadialGradient(sx, sy, sr, ex, ey, er) </p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">var obj = canvas.createRadialGradient(200, 200, 100, 200, 200, 200);</span><br><span class=\"line\">obj.addColorStop(0, &apos;red&apos;);</span><br><span class=\"line\">obj.addColorStop(1, &apos;blue&apos;);</span><br><span class=\"line\">canvas.fillStyle = obj ;</span><br><span class=\"line\">canvas.arc(200, 200, 200, 0, 360 * Math.PI / 180, false);</span><br><span class=\"line\">canvas.fill()</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<h3 id=\"文本\"><a href=\"#文本\" class=\"headerlink\" title=\"文本\"></a>文本</h3><ul>\n<li>strokeText(‘文字’, x, y) </li>\n<li>fillText(‘文字’, x, y) 填充字</li>\n<li>font = ‘60px 宋体’</li>\n<li>textAlign</li>\n<li>textBaseLine = ‘top/middle/bottom’</li>\n<li>measureText().width 只有文字宽度, 高度就是文字大小</li>\n<li>阴影<ul>\n<li>shadowOffsetX</li>\n<li>shadowOffsetY</li>\n<li>shadowColor(r, g, b) 默认透明黑色</li>\n<li>shadowBlur<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">canvas.font = &apos;60px 宋体&apos;</span><br><span class=\"line\">canvas.shadowOffsetX = 10</span><br><span class=\"line\">canvas.shadowColor = &apos;red&apos;</span><br><span class=\"line\">canvas.shadowBlur = 5</span><br><span class=\"line\">canvas.strokeText(&apos;Hello Wolrd&apos;, 200, 200)</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"默认样式\"><a href=\"#默认样式\" class=\"headerlink\" title=\"默认样式\"></a>默认样式</h3><ul>\n<li>默认宽300, 高150</li>\n</ul>\n"}