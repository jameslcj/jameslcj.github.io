{"tags":[{"name":"javaScript高级程序设计笔记","permalink":"wjcun.com/tags/javaScript高级程序设计笔记/","url":"/async/tags/javaScript高级程序设计笔记.json","count":17}],"categories":[],"url":"/async/posts/2017/09/23/最佳实践.json","date":1506166315000,"path":{"year":2017,"month":9,"day":23,"name":"最佳实践"},"title":"最佳实践","permalink":"wjcun.com/2017/09/23/最佳实践/","content":"<h2 id=\"性能\"><a href=\"#性能\" class=\"headerlink\" title=\"性能\"></a>性能</h2><h3 id=\"避免全局查找\"><a href=\"#避免全局查找\" class=\"headerlink\" title=\"避免全局查找\"></a>避免全局查找</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">function updateUI() &#123;</span><br><span class=\"line\">\tvar imgs = document.getElementByTagName(&quot;img&quot;);</span><br><span class=\"line\">\tfor (var i=0, len=imgs.length; i &lt; len; i++) &#123;</span><br><span class=\"line\">\t\timgs[i].title = document.title + &quot; images &quot; + i;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\tvar msg = document.getElementById(&quot;msg&quot;);</span><br><span class=\"line\">\tmsg.innerHTML = &quot;update complete.&quot;;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>上面代码包含了3次对全局document对象的引用, 如果for循环多次就会有多次的document作用域链的查找. 我们可以通过创建一个指向document对象的局部变量, 这边就避免了每次全局作用域的查找, 修改如下</p>\n</blockquote>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">function updateUI() &#123;</span><br><span class=\"line\">\tvar doc = document;</span><br><span class=\"line\">\tvar imgs = doc.getElementsByTagName(&quot;img&quot;);</span><br><span class=\"line\">\tfor (var i=0, len=imgs.length; i &lt; len; i++) &#123;</span><br><span class=\"line\">\t\timgs[i].title = doc.title + &quot; images &quot; + i;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\tvar msg = doc.getElmentById(&quot;msg&quot;);</span><br><span class=\"line\">\tmsg.innerHTML = &quot;update complete.&quot;;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"避免with语句\"><a href=\"#避免with语句\" class=\"headerlink\" title=\"避免with语句\"></a>避免with语句</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">function updateBody() &#123;</span><br><span class=\"line\">\twith (document.body) &#123;</span><br><span class=\"line\">\t\tinnerHTML = &quot;hello world&quot;;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>with会创建自己的作用域, 由于额外的作用域查找, 在with里的代码肯定会比外面的代码执行的慢, 建议使用局部变量来完成相同的事情而不引入新的作用域.</p>\n</blockquote>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">function updateBody() &#123;</span><br><span class=\"line\">\tvar body = document.body;</span><br><span class=\"line\">\tbody.innerHTML = &quot;hello world&quot;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n"}