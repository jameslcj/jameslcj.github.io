<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>hellolc</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="hellolc">
<meta property="og:url" content="http://blog.hellolc.com/page/4/index.html">
<meta property="og:site_name" content="hellolc">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="hellolc">
  
    <link rel="alternate" href="/atom.xml" title="hellolc" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">hellolc</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://blog.hellolc.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-JSON" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/09/06/JSON/" class="article-date">
  <time datetime="2017-09-06T02:46:26.000Z" itemprop="datePublished">2017-09-06</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/09/06/JSON/">JSON</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="解析与序列化"><a href="#解析与序列化" class="headerlink" title="解析与序列化"></a>解析与序列化</h2><h3 id="序列化选项"><a href="#序列化选项" class="headerlink" title="序列化选项"></a>序列化选项</h3><blockquote>
<p><code>JSON.stringify</code>第二个参数可以是个数组, 过滤掉其他参数, 只留下指定参数; </p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var obj = &#123;a: &apos;a&apos;, b: &apos;b&apos;, c:&apos;c&apos;&#125;</span><br><span class="line">JSON.stringify(obj, [&apos;a&apos;,&apos;c&apos;]) //&quot;&#123;&quot;a&quot;:&quot;a&quot;,&quot;c&quot;:&quot;c&quot;&#125;&quot;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>第二个参数也可以是个方法</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">var book = &#123;</span><br><span class="line">    &quot;title&quot;: &quot;Professional JavaScript&quot;,</span><br><span class="line">    &quot;authors&quot;: [&quot;Nicholas C. Zakas&quot;],</span><br><span class="line">    edition: 3,</span><br><span class="line">    year: 2001</span><br><span class="line">&#125;;</span><br><span class="line">var jsonText = JSON.stringify(book, function(key, value) &#123;</span><br><span class="line">    switch(key) &#123;</span><br><span class="line">        case &quot;authors&quot;:</span><br><span class="line">            return value.join(&quot;,&quot;);</span><br><span class="line">        case &quot;year&quot;:</span><br><span class="line">            return 5000;</span><br><span class="line">        case &quot;edition&quot;:</span><br><span class="line">            return undefined;</span><br><span class="line">        default:</span><br><span class="line">            return value;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line">jsonText; //&quot;&#123;&quot;title&quot;:&quot;Professional JavaScript&quot;,&quot;authors&quot;:&quot;Nicholas C. Zakas&quot;,&quot;year&quot;:5000&#125;&quot;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>第三个参数, 如果是数值可以指定缩进几个空格(最大缩进10), 也可以指定是字符串</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">var book = &#123;</span><br><span class="line">    &quot;title&quot;: &quot;Professional JavaScript&quot;,</span><br><span class="line">    &quot;authors&quot;: [&quot;Nicholas C. Zakas&quot;],</span><br><span class="line">    edition: 3,</span><br><span class="line">    year: 2001</span><br><span class="line">&#125;;</span><br><span class="line">var jsonText = JSON.stringify(book, null, 4);</span><br><span class="line">/** </span><br><span class="line">&quot;&#123;</span><br><span class="line">    &quot;title&quot;: &quot;Professional JavaScript&quot;,</span><br><span class="line">    &quot;authors&quot;: [</span><br><span class="line">        &quot;Nicholas C. Zakas&quot;</span><br><span class="line">    ],</span><br><span class="line">    &quot;edition&quot;: 3,</span><br><span class="line">    &quot;year&quot;: 2001</span><br><span class="line">&#125;&quot;**/</span><br><span class="line"></span><br><span class="line">JSON.stringify(book, null, &apos;-&apos;);</span><br><span class="line">/**</span><br><span class="line">&quot;&#123;</span><br><span class="line">-&quot;title&quot;: &quot;Professional JavaScript&quot;,</span><br><span class="line">-&quot;authors&quot;: [</span><br><span class="line">--&quot;Nicholas C. Zakas&quot;</span><br><span class="line">-],</span><br><span class="line">-&quot;edition&quot;: 3,</span><br><span class="line">-&quot;year&quot;: 2001</span><br><span class="line">&#125;&quot;*/</span><br></pre></td></tr></table></figure>
<ul>
<li>toJSON</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">var book = &#123;</span><br><span class="line">    &quot;title&quot;: &quot;Professional JavaScript&quot;,</span><br><span class="line">    &quot;authors&quot;: [&quot;Nicholas C. Zakas&quot;],</span><br><span class="line">    edition: 3,</span><br><span class="line">    year: 2001,</span><br><span class="line">    toJSON: function() &#123;</span><br><span class="line">        if (this.edition &gt; 3) &#123;</span><br><span class="line">            return &apos;big&apos;;</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            return &apos;small&apos;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">JSON.stringify(book) //&quot;small&quot;</span><br></pre></td></tr></table></figure>
<h2 id="解析选项"><a href="#解析选项" class="headerlink" title="解析选项"></a>解析选项</h2><h3 id="JSON-parse"><a href="#JSON-parse" class="headerlink" title="JSON.parse()"></a>JSON.parse()</h3>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://blog.hellolc.com/2017/09/06/JSON/" data-id="cl7e5jffg000edo5wenjb5zib" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javaScript高级程序设计笔记/">javaScript高级程序设计笔记</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-JavaScriptAndXml" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/09/05/JavaScriptAndXml/" class="article-date">
  <time datetime="2017-09-05T03:10:19.000Z" itemprop="datePublished">2017-09-05</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/09/05/JavaScriptAndXml/">JavaScriptAndXml</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="浏览器对xml-dom的支持"><a href="#浏览器对xml-dom的支持" class="headerlink" title="浏览器对xml dom的支持"></a>浏览器对xml dom的支持</h2><h3 id="DOMParser"><a href="#DOMParser" class="headerlink" title="DOMParser"></a>DOMParser</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">var parser = new  DOMParser()</span><br><span class="line">var xmldom = parser.parseFromString(&quot;&lt;root&gt;&lt;child/&gt;&lt;/root&gt;&quot;, &quot;text/xml&quot;)</span><br><span class="line"></span><br><span class="line">xmldom.documentElement.tagName//root</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://blog.hellolc.com/2017/09/05/JavaScriptAndXml/" data-id="cl7e5jffk000jdo5waxq37nzl" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javaScript高级程序设计笔记/">javaScript高级程序设计笔记</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-angular" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/09/03/angular/" class="article-date">
  <time datetime="2017-09-03T03:07:09.000Z" itemprop="datePublished">2017-09-03</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/09/03/angular/">angular</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="angular-module"><a href="#angular-module" class="headerlink" title="angular.module"></a>angular.module</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var module = angular.module(&apos;myApp&apos;, [依赖模块])</span><br></pre></td></tr></table></figure>
<ul>
<li>第一个参数: 模块名</li>
<li>第二个参数: 依赖模块</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&lt;html lang=&quot;en&quot; ng-app=&quot;myApp&quot;&gt;</span><br><span class="line">&lt;div ng-controller=&quot;test&quot;&gt;</span><br><span class="line">        &lt;p&gt;价格: &lt;input type=&quot;text&quot; ng-model=&quot;goods.price&quot;&gt;&lt;/p&gt;</span><br><span class="line">        &lt;p&gt;数量: &lt;input type=&quot;text&quot; ng-model=&quot;goods.amount&quot;&gt;&lt;/p&gt;</span><br><span class="line">        &lt;p&gt;费用: &lt;span&gt;&#123;&#123;getPrice() | currency:&apos;¥&apos;&#125;&#125;&lt;/span&gt;&lt;/p&gt;</span><br><span class="line">        &lt;p&gt;运费: &lt;span&gt;&#123;&#123;goods.fee | currency:&apos;¥&apos;&#125;&#125;&lt;/span&gt;&lt;/p&gt;</span><br><span class="line">        &lt;p&gt;总价: &lt;span&gt;&#123;&#123;getPrice() + goods.fee | currency:&apos;¥&apos;&#125;&#125;&lt;/span&gt;&lt;/p&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line">&lt;script type=&quot;text/javascript&quot;&gt;</span><br><span class="line">var module = angular.module(&apos;myApp&apos;, []);</span><br><span class="line">module.controller(&apos;test&apos;, function($timeout, $scope, $rootScope) &#123;</span><br><span class="line">    $scope.goods = &#123;</span><br><span class="line">        price: 5000,</span><br><span class="line">        amount: 5,</span><br><span class="line">        fee: 10</span><br><span class="line">    &#125;</span><br><span class="line">    $scope.getPrice = function() &#123;</span><br><span class="line">        return $scope.goods.price * $scope.goods.amount;</span><br><span class="line">    &#125;</span><br><span class="line">    $scope.$watch(&apos;goods&apos;, function() &#123;</span><br><span class="line">        //监听到goods.pprice变化 做相应操作</span><br><span class="line">        $scope.goods.fee = $scope.getPrice() &gt;= 100 ? 0 : 10;</span><br><span class="line">    &#125;, true)</span><br><span class="line">&#125;)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>为了避免压缩导致参数变化, controller的第二个参数可以变化为数组形式</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">function($scope, $rootScope) &#123;...&#125;</span><br><span class="line">====&gt;</span><br><span class="line">[&apos;$scope&apos;, &apos;$rootScope&apos;, function(p1, p2) &#123;...&#125;]</span><br></pre></td></tr></table></figure>
<ul>
<li><code>module.controller</code></li>
<li><code>module.run([&#39;$rootScope&#39;, function(p){...}])</code><ul>
<li>run可以不用再dom上指定ng-controller 就可以控制全局变量</li>
</ul>
</li>
<li><code>module.filter</code> 自定义过滤器</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;p&gt;&#123;&#123;name | myFilter&#125;&#125;&lt;/p&gt;</span><br><span class="line">var module = angular.module(&apos;myApp&apos;, []);</span><br><span class="line">module.filter(&apos;myFilter&apos;, function() &#123;</span><br><span class="line">    return function(str) &#123;</span><br><span class="line">        return str.charAt(0).toUpperCase() + str.substring(1);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<ul>
<li><code>module.directive</code> 自定义指令<ul>
<li>restrict的四种定义方式 <ol>
<li>区分大小写;</li>
<li>可以组合使用</li>
<li>注意驼峰转换 </li>
</ol>
<ul>
<li><code>E</code>: 标签指令</li>
<li><code>A</code>: 属性指令</li>
<li><code>C</code>: class属性</li>
<li><code>M</code>: 注释替换</li>
</ul>
</li>
</ul>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;my-hello&gt;&lt;/my-hello&gt;</span><br><span class="line">&lt;div my-hello&gt;&lt;/div&gt;</span><br><span class="line">&lt;div class=&quot;my-hello&quot;&gt;&lt;/div&gt;</span><br><span class="line">&lt;!-- directive:my-hello --&gt;</span><br><span class="line">module.directive(&apos;myHello&apos;, function() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">        restrict: &apos;EACM&apos;,</span><br><span class="line">        replace: true,</span><br><span class="line">        transclude: true,</span><br><span class="line">        controller: [&apos;$scope&apos;, function($scope) &#123;</span><br><span class="line">            this.tips = &apos;hello world&apos;</span><br><span class="line">        &#125;],</span><br><span class="line">        template: &apos;&lt;div&gt;Hello world &lt;h1 ng-transclude&gt;&lt;/h1&gt;&lt;/div&gt;&apos;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<pre><code>+ place
+ template: 模板标签
+ templateUrl: 模板文件 会用ajax 去请求
+ scope
    - 为true时 指令被服用时, 作用域会独立
    - 为`{}`时, 作用域会和全局作用域隔离开, 会使用自己的controller作用域及变量
        + `@`: 替换为变量
        + `=`: 替换为作用域变量(非自身controller作用域)
        + `&amp;`: 替换为函数(非自身controller作用域)
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;my-tab aaa=&quot;div1&quot; my-name=&quot;name&quot; my-fn=&quot;show(num)&quot;&gt;&lt;/my-tab&gt;</span><br><span class="line">    &lt;my-tab aaa=&quot;div2&quot; my-name=&quot;name&quot; my-fn=&quot;show(num)&quot;&gt;&lt;/my-tab&gt;</span><br><span class="line">module.directive(&apos;myTab&apos;, function() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">        restrict: &apos;E&apos;,</span><br><span class="line">        replace: true,</span><br><span class="line">        templateUrl: &apos;./tmp1.html&apos;,</span><br><span class="line">        scope: &#123;</span><br><span class="line">            myId: &apos;@aaa&apos;,</span><br><span class="line">            myName: &apos;=&apos;,</span><br><span class="line">            myFn: &apos;&amp;&apos;</span><br><span class="line">        &#125;,</span><br><span class="line">        controller: [&apos;$scope&apos;, function($scope) &#123;</span><br><span class="line">            $scope.name = &apos;mytab&apos;</span><br><span class="line">        &#125;],</span><br><span class="line">        link: function(scope, element, attr) &#123;</span><br><span class="line">            element.delegate(&apos;input&apos;, &apos;click&apos;, function() &#123;</span><br><span class="line">                $(this).attr(&apos;class&apos;, &apos;active&apos;).siblings().attr(&apos;class&apos;, &apos;&apos;)</span><br><span class="line">                $(this).siblings(&apos;div&apos;).css(&#123;&apos;display&apos;: &apos;none&apos;&#125;).siblings(&apos;div&apos;).eq($(this).index()).css(&#123;&apos;display&apos;: &apos;block&apos;&#125;)</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line">//./tmp1.html</span><br><span class="line">&lt;input class=&quot;active&quot; type=&quot;button&quot; value=&quot;1&quot; ng-click=&quot;myFn(&#123;num:123&#125;)&quot;&gt;</span><br></pre></td></tr></table></figure>
<pre><code>- link: 对自身的操作
- controller: 当对`this`挂载数据时, 就实现了与其他自定义指令, 进行数据共享
- transclude: 当为true时保留子模板
- require: 引入其他自定义指令
    + `?`防止报错
    + `^`向上级查找
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;my-hello&gt;&lt;my-hi&gt;&lt;/my-hi&gt;&lt;/my-hello&gt;</span><br><span class="line">module.directive(&apos;myHello&apos;, function() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">        restrict: &apos;EACM&apos;,</span><br><span class="line">        replace: true,</span><br><span class="line">        transclude: true,</span><br><span class="line">        controller: [&apos;$scope&apos;, function($scope) &#123;</span><br><span class="line">            this.tips = &apos;hello world&apos;</span><br><span class="line">        &#125;],</span><br><span class="line">        template: &apos;&lt;div&gt;Hello world &lt;h1 ng-transclude&gt;&lt;/h1&gt;&lt;/div&gt;&apos;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line">module.directive(&apos;myHi&apos;, function() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">        restrict: &apos;EACM&apos;,</span><br><span class="line">        replace: true,</span><br><span class="line">        require: &apos;?^myHello&apos;,</span><br><span class="line">        template: &apos;&lt;span&gt;hi world&lt;/span&gt;&apos;,</span><br><span class="line">        link: function(scope1, element1, attr, reController) &#123;</span><br><span class="line">            console.log(reController.tips)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<ul>
<li>module.config 服务商 根据配置信息用于初始化操作 <ul>
<li>参数+Provider</li>
</ul>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">module.config([&apos;$interpolateProvider&apos;, function($interpolateProvider) &#123;</span><br><span class="line">    //替换标识符</span><br><span class="line">    $interpolateProvider.startSymbol(&apos;@@&apos;);</span><br><span class="line">    $interpolateProvider.endSymbol(&apos;@@&apos;);</span><br><span class="line">])</span><br></pre></td></tr></table></figure>
<ul>
<li>module.factory(‘服务名’, fn) 自定义服务</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">module.factory(&apos;myService&apos;, function() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">        myServiceFn: function() &#123;</span><br><span class="line">            console.log(&apos;hello myService&apos;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line">module.controller(&apos;test&apos;, [&apos;$scope&apos;, &apos;myService&apos;, function ($scope, myService)&#123;</span><br><span class="line">    console.log(myService.myServiceFn())</span><br><span class="line">&#125;]);</span><br></pre></td></tr></table></figure>
<ul>
<li>module.service 支持面向对象的自定义服务</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">module.service(&apos;myServiceObj&apos;, myServiceObjFn);</span><br><span class="line">function myServiceObjFn() &#123;</span><br><span class="line">    this.name = &apos;myServiceObjFn&apos;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">myServiceObjFn.prototype.age = 18</span><br></pre></td></tr></table></figure>
<ul>
<li>module.constant 自定义常量的服务</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">module.constant(&apos;myServiceConst&apos;, &apos;hello myServiceConst&apos;)</span><br><span class="line">module.config([&apos;myServiceConst&apos;, function(myServiceConst) &#123;</span><br><span class="line">    console.log(myServiceConst)</span><br><span class="line">&#125;])</span><br></pre></td></tr></table></figure>
<ul>
<li><p>module.value 自定义常量的服务 但是不能config配置</p>
</li>
<li><p>module.provider(‘服务名’, fn)</p>
<ul>
<li>功能与factory类似, 因为factory通过这个方法封装</li>
<li>与factory的区别是: 这个方法可以进行config服务商 进行初始化操作</li>
</ul>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">module.provider(&apos;myService2&apos;, function() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">        flag: false,</span><br><span class="line">        $get: function() &#123;</span><br><span class="line">            var _this = this;</span><br><span class="line">            return function(num1, num2) &#123;</span><br><span class="line">                var tmp = Math.random() * (num2 - num1) + num1</span><br><span class="line">                return _this.flag ? Math.round(tmp) : tmp;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line">module.config([&apos;myService2Provider&apos;, function(myService2Provider) &#123;</span><br><span class="line">    myService2Provider.flag = false;</span><br><span class="line">&#125;])</span><br></pre></td></tr></table></figure>
<h2 id="指令"><a href="#指令" class="headerlink" title="指令"></a>指令</h2><ul>
<li>ng-app<ul>
<li>初始化作用, 初始化模块</li>
<li>只有在声明了ng-app区域, angular才生效 </li>
</ul>
</li>
<li>ng-controller</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">//常规模式</span><br><span class="line">module.controller(&apos;test&apos;, [&apos;$scope&apos;, &apos;$rootScope&apos;, &apos;$filter&apos;, &apos;$interval&apos;, function($scope, $rootScope, $filter, $interval) &#123;&#125;];</span><br><span class="line">&lt;div ng-controller=&quot;test&quot;&gt;&lt;/div&gt;</span><br><span class="line">//面向对象形式</span><br><span class="line">module.controller(&apos;test2&apos;, [&apos;$scope&apos;, fn]);</span><br><span class="line">function fn() &#123;&#125;</span><br><span class="line">fn.prototype.name = &apos;fnObj&apos;</span><br><span class="line">&lt;div ng-controller=&quot;fn as fnObj&quot;&gt;&#123;&#123;fnObj.name&#125;&#125;&lt;/div&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>ng-click 点击事件<ul>
<li>可以直接修改$scope上的变量 ==&gt; <code>ng-click=&quot;name=&#39;aa&#39;&quot;</code></li>
<li>也可以在$scope上绑定一个方法再调用</li>
</ul>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ng-click=&quot;changeName()&quot;</span><br><span class="line">$scope.changeName = function() &#123;</span><br><span class="line">        $scope.name = &apos;name&apos;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>ng-model 双向绑定<ul>
<li><code>ng-model=&quot;name&quot;</code> 与name变量绑定在一起, name变量的变化会影响绑定对象</li>
</ul>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;body &gt;</span><br><span class="line">    &lt;div ng-controller=&quot;test&quot;&gt;</span><br><span class="line">        &lt;p&gt;价格: &lt;input type=&quot;text&quot; ng-model=&quot;goods.price&quot;&gt;&lt;/p&gt;</span><br><span class="line">        &lt;p&gt;数量: &lt;input type=&quot;text&quot; ng-model=&quot;goods.amount&quot;&gt;&lt;/p&gt;</span><br><span class="line">        &lt;p&gt;费用: &lt;span&gt;&#123;&#123;getPrice() | currency:&apos;¥&apos;&#125;&#125;&lt;/span&gt;&lt;/p&gt;</span><br><span class="line">        &lt;p&gt;运费: &lt;span&gt;&#123;&#123;goods.fee | currency:&apos;¥&apos;&#125;&#125;&lt;/span&gt;&lt;/p&gt;</span><br><span class="line">        &lt;p&gt;总价: &lt;span&gt;&#123;&#123;getPrice() + goods.fee | currency:&apos;¥&apos;&#125;&#125;&lt;/span&gt;&lt;/p&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;script type=&quot;text/javascript&quot;&gt;</span><br><span class="line">    function test($timeout, $scope, $rootScope) &#123;</span><br><span class="line">        $scope.goods = &#123;</span><br><span class="line">            price: 5000,</span><br><span class="line">            amount: 5,</span><br><span class="line">            fee: 10</span><br><span class="line">        &#125;</span><br><span class="line">        $scope.getPrice = function() &#123;</span><br><span class="line">            return $scope.goods.price * $scope.goods.amount;</span><br><span class="line">        &#125;</span><br><span class="line">        $scope.$watch(&apos;goods&apos;, function() &#123;</span><br><span class="line">            //监听到goods.pprice变化 做相应操作</span><br><span class="line">            $scope.goods.fee = $scope.getPrice() &gt;= 100 ? 0 : 10;</span><br><span class="line">        &#125;, true)</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>ng-model-option<ul>
<li>ng-model的一些特殊处理</li>
</ul>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//丢失光标才触发model</span><br><span class="line">&lt;input ng-model=&quot;data&quot; ng-model-option=&quot;&#123;updateOn: &apos;blur&apos;&#125;&quot; /&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>ng-repeat<ul>
<li>$index 显示索引</li>
<li>$first 是否第一个</li>
<li>$last 是否最后一个</li>
<li>middle 是否非首非尾</li>
<li>even 是否偶数</li>
<li>odd 是否奇数</li>
<li>ng-repeat-start ng-ng-repat-end 两者要配合使用 数据将会在这区间有效输出</li>
</ul>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;ul&gt;</span><br><span class="line">    &lt;li ng-repeat=&quot;item in items&quot;&gt;&#123;&#123;item.data&#125;&#125;&lt;/li&gt;</span><br><span class="line">&lt;/ul&gt;</span><br><span class="line">$scope.items = [</span><br><span class="line">        &#123;</span><br><span class="line">            data: &apos;angular&apos;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            data: &apos;vue&apos;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            data: &apos;react&apos;</span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br></pre></td></tr></table></figure>
<ul>
<li>ng-select select框选中事件</li>
<li>ng-change 改变事件 需要model配合</li>
<li>ng-copy 复制事件</li>
<li>ng-cut 剪切事件</li>
<li>ng-paste 粘贴事件</li>
<li>ng-disabled</li>
<li>ng-readonly</li>
<li>ng-checkd</li>
<li>ng-value<ul>
<li>使用原生value时, 当js还没执行时, 在页面上就直接显示<code></code>, 用户体验不好, 使用<code>ng-value</code>就可以避免这些问题</li>
</ul>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">value=&quot;&#123;&#123;name&#125;&#125;&quot; ===&gt; ng-value=&quot;name&quot;</span><br></pre></td></tr></table></figure>
<ul>
<li>ng-bind<ul>
<li>ng-bind 与ng-value类似 都是为了提高体验, 在js还没执行时, 模板tag不会直接显示在页面上 </li>
</ul>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;div&gt;&#123;&#123;name&#125;&#125;&gt;&gt;</span><br><span class="line">//===&gt;等价于</span><br><span class="line">&lt;div gn-bind=&quot;name&quot;&gt;&lt;/div&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>ng-bind-templete<ul>
<li>功能与ng-bind类似 只不过可以直接用模板</li>
</ul>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;div&gt;&#123;&#123;name&#125;&#125;,&#123;&#123;name&#125;&#125;&gt;&gt;</span><br><span class="line">//===&gt;等价于</span><br><span class="line">&lt;div gn-bind-templete=&quot;&#123;&#123;name&#125;&#125;,&#123;&#123;name&#125;&#125;&quot;&gt;&lt;/div&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>ng-bind-html<ul>
<li>前面2个是无法解析html便签的, 但这个指令是可以解析的</li>
<li>但是需要引入<code>ngSanitize</code>模块</li>
</ul>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">var module = angular.module(&apos;myApp&apos;, [&apos;ngSanitize&apos;]);</span><br><span class="line">$scope.test = &quot;&lt;h1&gt;hello&lt;/h1&gt;&quot;</span><br><span class="line">&lt;div ng-bind-html=&quot;test&quot;&gt;&lt;/div&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>ng-clock<ul>
<li>也是js未渲染完毕, 不显示便签</li>
<li>其原理是先给样式套上<code>display:none</code>, 渲染完毕后, 再设置为<code>display:block</code></li>
</ul>
</li>
<li>ng-non-bindable<ul>
<li>不解析便签 </li>
</ul>
</li>
<li>ng-class<ul>
<li>添加class</li>
<li>也可以使用<code>$scope</code>变量, 但变量要用<code>\{\{\}\}</code>包裹起来</li>
</ul>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;div ng-class=&quot;&#123;class名: true, class名2: true&#125;&quot;&gt;&lt;div&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>ng-style<ul>
<li>可以直接设置样式</li>
<li>使用的对象方式 <code>{color: &#39;red&#39;}</code></li>
<li>也可以使用$scope变量, 但变量要用<code>\{\{\}\}</code>包裹起来</li>
</ul>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$scope.style = &quot;&#123;color: &apos;red&apos;, background: &apos;blue&apos;&#125;&quot;</span><br><span class="line">&lt;div ng-style=&quot;&#123;&#123;style&#125;&#125;&quot;&gt;&lt;div&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>ng-href</li>
<li>ng-src</li>
<li>ng-attr-属性名<ul>
<li>例如: ng-attr-id</li>
</ul>
</li>
<li>ng-show 显示 <code>ng-show=&quot;true&quot;</code></li>
<li>ng-hide 隐藏</li>
<li>ng-if<ul>
<li>功能和<code>ng-show</code>类似</li>
<li>但是<code>ng-if</code>是对dom进行增删操作 </li>
</ul>
</li>
<li>ng-switch</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;input type=&quot;checkbox&quot; name=&quot;&quot; ng-model=&quot;checkbox&quot;&gt;</span><br><span class="line">&lt;div ng-switch on=&quot;checkbox&quot;&gt;</span><br><span class="line">    &lt;p ng-switch-default&gt;ng-switch-default&lt;/p&gt;</span><br><span class="line">    &lt;p ng-switch-when=&quot;false&quot;&gt;ng-switch-when&lt;/p&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>ng-open 与detail关联使用</li>
<li>ng-init 初始化变量, 不用先在$scope上挂载</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;div ng-init=&quot;init=&apos;hello&apos;&quot;&gt;&#123;&#123;init&#125;&#125;&lt;/div&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>ng-include 引入其他 模块</li>
</ul>
<h3 id="angular重装标签"><a href="#angular重装标签" class="headerlink" title="angular重装标签"></a>angular重装标签</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">var module = angular.module(&apos;myApp&apos;, [&apos;ngSanitize&apos;]);</span><br><span class="line">module.controller(&apos;test2&apos;, [&apos;$scope&apos;, fn]);</span><br><span class="line">function fn() &#123;&#125;</span><br><span class="line">fn.prototype.colors = [</span><br><span class="line">    &#123;name: &apos;red&apos;&#125;,</span><br><span class="line">    &#123;name: &apos;yellow&apos;&#125;,</span><br><span class="line">    &#123;name: &apos;blue&apos;&#125;,</span><br><span class="line">]</span><br><span class="line">&lt;div ng-controller=&quot;fn as fnObj&quot;&gt;</span><br><span class="line">    &lt;a href=&quot;&quot;&gt;&#123;&#123;myColor.name&#125;&#125;&lt;/a&gt;</span><br><span class="line">    &lt;select ng-options=&quot;color.name for color in fnObj.colors&quot; ng-model=&quot;myColor&quot;&gt;&lt;/select&gt;</span><br><span class="line">    &lt;form name=&quot;myForm&quot;&gt;</span><br><span class="line">        &lt;input type=&quot;email&quot; ng-model=&quot;fnObj.name&quot; name=&quot;myInput&quot;&gt;</span><br><span class="line">        &lt;p&gt;验证通过: &#123;&#123;myForm.myInput.$valid&#125;&#125;&lt;/p&gt;</span><br><span class="line">        &lt;p&gt;验证不通过: &#123;&#123;myForm.myInput.$invalid&#125;&#125;&lt;/p&gt;</span><br><span class="line">        &lt;p&gt;初始值: &#123;&#123;myForm.myInput.$pristine&#125;&#125;&lt;/p&gt;</span><br><span class="line">        &lt;p&gt;修改过: &#123;&#123;myForm.myInput.$dirty&#125;&#125;&lt;/p&gt;</span><br><span class="line">        &lt;p&gt;有错误: &#123;&#123;myForm.myInput.$error&#125;&#125;&lt;/p&gt;</span><br><span class="line">    &lt;/form&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure>
<h2 id="参数"><a href="#参数" class="headerlink" title="参数"></a>参数</h2><ul>
<li>angluar是依赖注入, 所有它传递的形参名称不能修改</li>
<li>参数顺序可以改变</li>
</ul>
<h3 id="scope"><a href="#scope" class="headerlink" title="$scope"></a>$scope</h3><ul>
<li>局部作用域</li>
<li>只有在绑定的ng-controller区域才可以使用</li>
<li>挂载这个对象上的变量, 才能在模板里显示</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;div ng-controller=&quot;test&quot;&gt;</span><br><span class="line">        &#123;&#123;name&#125;&#125;</span><br><span class="line">    &lt;/div&gt;    </span><br><span class="line">    &#123;&#123;age&#125;&#125;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;script type=&quot;text/javascript&quot;&gt;</span><br><span class="line">    function test($scope, $rootScope) &#123;</span><br><span class="line">        $scope.name = &apos;lc&apos;</span><br><span class="line">        $rootScope.age = 18</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<h4 id="scope-watch"><a href="#scope-watch" class="headerlink" title="$scope.$watch"></a>$scope.$watch</h4><ul>
<li>监听器</li>
<li>第一个参数 监听对象</li>
<li>第二个参数 监听触发的回调函数<ul>
<li>回调函数带有3个参数</li>
<li>第一个参数, 新的变量值</li>
<li>第二个参数, 旧的变量值 </li>
</ul>
</li>
<li>第三个参数 boolen 是否深度监听, 也就是说对象里面的子变量或子对象</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$scope.$watch(&apos;goods.price&apos;, function() &#123;</span><br><span class="line">    //监听到对象变化 做相应操作</span><br><span class="line">&#125;, true)</span><br></pre></td></tr></table></figure>
<h4 id="scope-apply"><a href="#scope-apply" class="headerlink" title="$scope.$apply"></a>$scope.$apply</h4><ul>
<li>一般情况下, setTimeout是没法生效的, 必须使用$timeout, 但是使用$scope.$apply, setTimeout就可以生效</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">setTimeout(function() &#123;</span><br><span class="line">        $scope.$apply(function() &#123;</span><br><span class="line">            $scope.goods.amount = 100</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;, 1000)</span><br></pre></td></tr></table></figure>
<h3 id="rootScope"><a href="#rootScope" class="headerlink" title="$rootScope"></a>$rootScope</h3><ul>
<li>全局作用域</li>
<li>挂载在这个对象上的变量, 在全局可生效</li>
</ul>
<h3 id="timeout"><a href="#timeout" class="headerlink" title="$timeout"></a>$timeout</h3><ul>
<li>功能和setTimeout相似, 但setTimeout无法修改angular变量现实双向绑定</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$timeout(function() &#123;</span><br><span class="line">            $scope.name = &apos;ll&apos;</span><br><span class="line">        &#125;, 1000)</span><br></pre></td></tr></table></figure>
<h3 id="interval"><a href="#interval" class="headerlink" title="$interval"></a>$interval</h3><ul>
<li>$interval.cancel(timer)</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">var timer = $interval(function() &#123;</span><br><span class="line">        $scope.text = iNow + &apos;秒&apos;;</span><br><span class="line">        if (! iNow --) &#123;</span><br><span class="line">            $scope.text = &apos;搜索&apos;;</span><br><span class="line">            $scope.isDisabled = false</span><br><span class="line">            $interval.cancel(timer)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;, 1000);</span><br></pre></td></tr></table></figure>
<h3 id="filter-过滤器"><a href="#filter-过滤器" class="headerlink" title="$filter 过滤器"></a>$filter 过滤器</h3><ul>
<li><code>$filter(&#39;过滤器名&#39;).(操作对象, 过滤器参数...)</code></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">alert($filter(&apos;uppercase&apos;)(&apos;hello&apos;)</span><br><span class="line">alert($filter(&apos;limitTo&apos;)(&apos;hello&apos;, 2))</span><br></pre></td></tr></table></figure>
<h3 id="http-类似ajax的http请求"><a href="#http-类似ajax的http请求" class="headerlink" title="$http 类似ajax的http请求"></a>$http 类似ajax的http请求</h3><ul>
<li>当<code>method: &#39;jsonp&#39;</code>时, <code>JSON_CALLBACK</code>为回调函数名</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">$scope.searchByBaidu = function() &#123;</span><br><span class="line">    $timeout.cancel(timer);</span><br><span class="line">    $timeout(function () &#123;</span><br><span class="line">        $http(&#123;</span><br><span class="line">            method: &apos;jsonp&apos;,</span><br><span class="line">            url: &apos;https://sp0.baidu.com/5a1Fazu8AA54nxGko9WTAnF6hhy/su?wd=&apos; + $scope.searchData + &apos;&amp;json=1&amp;cb=JSON_CALLBACK&apos;</span><br><span class="line">        &#125;).success(function(data, state, headers, config) &#123;</span><br><span class="line">            console.log(data)</span><br><span class="line">            $scope.searchResult = data.g</span><br><span class="line">        &#125;).error(function(err) &#123;</span><br><span class="line">            console.log(err)</span><br><span class="line">        &#125;)</span><br><span class="line">        </span><br><span class="line">    &#125;, 500);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="location-对location的封装"><a href="#location-对location的封装" class="headerlink" title="$location 对location的封装"></a>$location 对location的封装</h3><ul>
<li><code>$location.path(&#39;aaa/bbb&#39;)</code> 在hash后面设置路径</li>
</ul>
<h3 id="anchorScroller-锚点跳转"><a href="#anchorScroller-锚点跳转" class="headerlink" title="$anchorScroller 锚点跳转"></a>$anchorScroller 锚点跳转</h3><h3 id="cacheFactory-缓存工具"><a href="#cacheFactory-缓存工具" class="headerlink" title="cacheFactory 缓存工具"></a>cacheFactory 缓存工具</h3><ul>
<li>info() 缓存信息</li>
<li>get(key) 获取缓存</li>
<li>put(key, val) 存储缓存</li>
<li>remove(key)</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">var cache = $cacheFactory(&apos;myCache&apos;, &#123;capacity: 1&#125;) // capacity 缓存最大空间</span><br><span class="line">cache.put(&apos;name&apos;, &apos;lc&apos;)</span><br><span class="line">cache.put(&apos;age&apos;, &apos;18&apos;)</span><br><span class="line">console.log(cache.info, cache.get(&apos;name&apos;), cache.get(&apos;age&apos;))</span><br></pre></td></tr></table></figure>
<h3 id="log-功能与console类似"><a href="#log-功能与console类似" class="headerlink" title="$log 功能与console类似"></a>$log 功能与console类似</h3><h3 id="interpolate-插值替换"><a href="#interpolate-插值替换" class="headerlink" title="$interpolate 插值替换"></a>$interpolate 插值替换</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;input type=&quot;text&quot;  ng-model=&quot;name&quot;&gt;</span><br><span class="line">&lt;textarea ng-model=&quot;body&quot;&gt;&lt;/textarea&gt;</span><br><span class="line">&lt;p&gt;&#123;&#123;showBodyContent&#125;&#125;&lt;/p&gt;</span><br><span class="line">$scope.$watch(&apos;body&apos;, function(newBody) &#123;</span><br><span class="line">    if (newBody) &#123;</span><br><span class="line">        //解析新内容</span><br><span class="line">        var template = $interpolate(newBody);</span><br><span class="line">        //将内容中的name替换为$scope中的name</span><br><span class="line">        $scope.showBodyContent = template(&#123;name: $scope.name&#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="q-跟jquery的primise类似"><a href="#q-跟jquery的primise类似" class="headerlink" title="$q 跟jquery的primise类似"></a>$q 跟jquery的primise类似</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">var dfd = $q.defer();</span><br><span class="line">function getPromise() &#123;</span><br><span class="line">    setTimeout(function() &#123;</span><br><span class="line">        if (Math.random() &gt; 0.5) &#123;</span><br><span class="line">            dfd.reject()</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            dfd.resolve();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;, 2000);</span><br><span class="line">    return dfd.promise;</span><br><span class="line">&#125;</span><br><span class="line">getPromise().then(function() &#123;</span><br><span class="line">    console.log(&apos;success&apos;)</span><br><span class="line">&#125;, function() &#123;</span><br><span class="line">    console.log(&apos;error&apos;)</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h2 id="angular-工具方法"><a href="#angular-工具方法" class="headerlink" title="angular 工具方法"></a>angular 工具方法</h2><h3 id="angular-bind"><a href="#angular-bind" class="headerlink" title="angular.bind"></a>angular.bind</h3><ul>
<li>功能与$.proxy类似</li>
</ul>
<h3 id="angular-extend"><a href="#angular-extend" class="headerlink" title="angular.extend"></a>angular.extend</h3><ul>
<li>功能与$.extend 类似</li>
</ul>
<h3 id="angular-copy"><a href="#angular-copy" class="headerlink" title="angular.copy"></a>angular.copy</h3><ul>
<li>复制功能 </li>
</ul>
<h3 id="angular-equals-a-b"><a href="#angular-equals-a-b" class="headerlink" title="angular.equals(a, b)"></a>angular.equals(a, b)</h3><ul>
<li>这个比较与原生的有所不同</li>
<li>这个方法只要比较的两者值一样就相同, 比如NaN</li>
</ul>
<h3 id="angular-forEach"><a href="#angular-forEach" class="headerlink" title="angular.forEach()"></a>angular.forEach()</h3><ul>
<li>接受3个参数, 前2个参数和$一样</li>
<li>第三个参数, 可以接受新值</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">var arr = [&apos;a&apos;, &apos;b&apos;]</span><br><span class="line">var result = []</span><br><span class="line">angular.forEach(arr, function(val, key)&#123;</span><br><span class="line">    this.push(key + val)</span><br><span class="line">&#125;, result)</span><br><span class="line">console.log(result)// [&quot;0a&quot;, &quot;1b&quot;]</span><br></pre></td></tr></table></figure>
<h3 id="angular-fromJson"><a href="#angular-fromJson" class="headerlink" title="angular.fromJson"></a>angular.fromJson</h3><ul>
<li>将字符串转换为json</li>
</ul>
<h3 id="angular-toJson"><a href="#angular-toJson" class="headerlink" title="angular.toJson"></a>angular.toJson</h3><ul>
<li>将json转换为字符串</li>
<li>第二个参数为true的话, json对象会被格式化</li>
</ul>
<h3 id="angular-element"><a href="#angular-element" class="headerlink" title="angular.element"></a>angular.element</h3><ul>
<li>小型jquery</li>
</ul>
<h3 id="angular-bootstarp"><a href="#angular-bootstarp" class="headerlink" title="angular.bootstarp"></a>angular.bootstarp</h3><ul>
<li>手动进行初始化, 与ng-app功能类似</li>
<li>但ng-app一个页面只能有一次初始化; 而bootstrap 可以进行多次初始化操作</li>
<li><code>angular.bootstarp(dom对象, module模块名)</code><ul>
<li>第一个参数, 在哪个dom对象上初始化</li>
<li>第二个参数, module的模块名</li>
</ul>
</li>
</ul>
<h2 id="过滤器"><a href="#过滤器" class="headerlink" title="过滤器"></a>过滤器</h2><blockquote>
<p>可以使用管道方式调用多个过滤器 如: num | limitTo: 2 | uppercase</p>
</blockquote>
<ul>
<li><code>currency:&#39;¥&#39;</code> 货币过滤器<ul>
<li><code>\{\{goods.price * goods.amount | currency\}\}</code> <code>| currency</code>是过滤器, 转换为货币格式</li>
</ul>
</li>
<li>number 每3位一个逗号</li>
<li>uppercase/lowercase</li>
<li>json 将json格式化</li>
<li>limitTo:1 截取数组或者字符串</li>
<li>date: ‘yyyy-mm-dd’ 转换为时间</li>
<li>orderBy:排序属性:是否逆序  排序对象</li>
<li>filter:值 过滤数据, 仅剩下含有此值的数据 </li>
</ul>
<h2 id="事件"><a href="#事件" class="headerlink" title="事件"></a>事件</h2><ul>
<li>$emit 冒泡传播</li>
<li>$broadcast 捕捉传播</li>
<li>event.stopPropagation 阻止事件传播</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;div ng-controller=&quot;testPropagation&quot;&gt;</span><br><span class="line">    &#123;&#123;count&#125;&#125;</span><br><span class="line">    &lt;div ng-controller=&quot;testPropagation&quot; ng-click=&quot;$emit(&apos;myEventInc&apos;);$broadcast(&apos;myEventDes&apos;)&quot;&gt;</span><br><span class="line">        &#123;&#123;count&#125;&#125;</span><br><span class="line">        &lt;div ng-controller=&quot;testPropagation&quot;&gt;</span><br><span class="line">            &#123;&#123;count&#125;&#125;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">module.controller(&apos;testPropagation&apos;, function($scope) &#123;</span><br><span class="line">    $scope.count = 0;</span><br><span class="line">    $scope.$on(&apos;myEventInc&apos;, function(event) &#123;</span><br><span class="line">        $scope.count ++;</span><br><span class="line">        // event.stopPropagation() //阻止事件传播</span><br><span class="line">    &#125;)</span><br><span class="line">    $scope.$on(&apos;myEventDes&apos;, function(event) &#123;</span><br><span class="line">        $scope.count --</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h2 id="插件"><a href="#插件" class="headerlink" title="插件"></a>插件</h2><h3 id="ng-route"><a href="#ng-route" class="headerlink" title="ng-route"></a>ng-route</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">&lt;div ng-controller=&quot;myController&quot;&gt;</span><br><span class="line">        &lt;a href=&quot;&quot; ng-click=&quot;$location.path(&apos;/aaa/123&apos;)&quot;&gt;首页123&lt;/a&gt;</span><br><span class="line">        &lt;a href=&quot;&quot; ng-click=&quot;$location.path(&apos;/aaa/345&apos;)&quot;&gt;首页345&lt;/a&gt;</span><br><span class="line">        &lt;a href=&quot;#bbb&quot;&gt;内容&lt;/a&gt;</span><br><span class="line">        &lt;a href=&quot;#ccc&quot;&gt;关于&lt;/a&gt;</span><br><span class="line">        &lt;div ng-view&gt;&lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">var module = angular.module(&apos;myApp&apos;, [&apos;ngRoute&apos;]);</span><br><span class="line">module.config([&apos;$routeProvider&apos;, function($routeProvider) &#123;</span><br><span class="line">    $routeProvider</span><br><span class="line">    .when(&apos;/aaa/:num&apos;, &#123;</span><br><span class="line">        template: &apos;&lt;div&gt;首页内容&lt;/div&gt;&#123;&#123;name&#125;&#125;&apos;,</span><br><span class="line">        controller: &apos;aaa&apos;</span><br><span class="line">    &#125;).when(&apos;/bbb&apos;, &#123;</span><br><span class="line">        template: &apos;&lt;div&gt;内容部分&lt;/div&gt;&#123;&#123;name&#125;&#125;&apos;,</span><br><span class="line">        controller: &apos;bbb&apos;</span><br><span class="line">    &#125;).when(&apos;/ccc&apos;, &#123;</span><br><span class="line">        template: &apos;&lt;div&gt;关于内容&lt;/div&gt;&#123;&#123;name&#125;&#125;&apos;,</span><br><span class="line">        controller: &apos;ccc&apos;</span><br><span class="line">    &#125;).otherwise(&#123;</span><br><span class="line">        redirectTo: &apos;/aaa/123&apos;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;])</span><br><span class="line">module.run([&apos;$rootScope&apos;, function($rootScope) &#123;</span><br><span class="line">    $rootScope.$on(&apos;$routeChangeStart&apos;, function(event, current, prev) &#123;</span><br><span class="line">        console.log(event, current, prev)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;])</span><br><span class="line">module.controller(&apos;myController&apos;, function($scope, $location, $routeParams) &#123;</span><br><span class="line">    $scope.$location = $location;</span><br><span class="line">    console.log($routeParams)</span><br><span class="line">&#125;)</span><br><span class="line">module.controller(&apos;aaa&apos;, function($scope) &#123;</span><br><span class="line">    $scope.name = &apos;aaa&apos;</span><br><span class="line">&#125;)</span><br><span class="line">module.controller(&apos;bbb&apos;, function($scope) &#123;</span><br><span class="line">    $scope.name = &apos;bbb&apos;</span><br><span class="line">&#125;)</span><br><span class="line">module.controller(&apos;ccc&apos;, function($scope) &#123;</span><br><span class="line">    $scope.name = &apos;ccc&apos;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="ngAnimate"><a href="#ngAnimate" class="headerlink" title="ngAnimate"></a>ngAnimate</h3><ul>
<li>对dom增删动画<ul>
<li>ng-enter</li>
<li>ng-enter-active</li>
<li>ng-leave</li>
<li>ng-leave-active</li>
</ul>
</li>
<li>对dom隐藏或显示<ul>
<li>ng-hide-remove</li>
<li>ng-hide-remove-active</li>
<li>ng-hide-add</li>
<li>ng-hide-add-active<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">.box &#123;</span><br><span class="line">    width: 200px;</span><br><span class="line">    height: 200px;</span><br><span class="line">    background-color: red;</span><br><span class="line">    transition: 1s all;</span><br><span class="line">&#125;</span><br><span class="line">.box.ng-enter &#123;</span><br><span class="line">    opacity: 0;</span><br><span class="line">&#125;</span><br><span class="line">.box.ng-enter-active &#123;</span><br><span class="line">    opacity: 1;</span><br><span class="line">&#125;</span><br><span class="line">.box.ng-leave &#123;</span><br><span class="line">    opacity: 1;</span><br><span class="line">&#125;</span><br><span class="line">.box.ng-leave-active &#123;</span><br><span class="line">    opacity: 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<ul>
<li>enter</li>
<li>leave</li>
<li>addClass</li>
<li>removeClass</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;div class=&quot;box&quot; ng-if=&quot;checkbox&quot;&gt;&lt;/div&gt;</span><br><span class="line">module.animation(&apos;.box&apos;, function() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">        enter: function(element, callback) &#123;</span><br><span class="line">            console.log(element, callback)</span><br><span class="line">        &#125;,</span><br><span class="line">        leave: function(element, callback) &#123;</span><br><span class="line">            console.log(element, callback)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line">&lt;div class=&quot;box&quot; ng-show=&quot;checkbox&quot;&gt;&lt;/div&gt;</span><br><span class="line">module.animation(&apos;.box&apos;, function() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">        addClass: function(element, aclass, callback) &#123;</span><br><span class="line">            console.log(element, aclass, callback)</span><br><span class="line">        &#125;,</span><br><span class="line">        removeClass: function(element, aclass, callback) &#123;</span><br><span class="line">            console.log(element, aclass, callback)</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="ngResource-大型资源请求-跟-http类似"><a href="#ngResource-大型资源请求-跟-http类似" class="headerlink" title="ngResource 大型资源请求 跟$http类似"></a>ngResource 大型资源请求 跟$http类似</h3><ul>
<li>get() get请求</li>
<li>query() 数组类似数据</li>
<li>save() post请求</li>
<li>delete()</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">// 初始化对象, 第一个参数是请求地址 第二个是字符替换, 第三个是初始化配置</span><br><span class="line">var obj = $resource(&apos;:name.:format&apos;, &#123;format: &apos;json&apos;&#125;, &#123;&#125;);</span><br><span class="line">obj.get(&#123;name: &apos;lisi&apos;&#125;, function()&#123;alert(&apos;success&apos;)&#125;, function()&#123;alert(&apos;error&apos;);&#125;)</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://blog.hellolc.com/2017/09/03/angular/" data-id="cl7e5jfga001mdo5wedb9s4lk" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/JavaScript/">JavaScript</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-HTML5脚本编程" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/08/31/HTML5脚本编程/" class="article-date">
  <time datetime="2017-08-31T01:56:59.000Z" itemprop="datePublished">2017-08-31</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/08/31/HTML5脚本编程/">HTML5脚本编程</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="跨文档消息传递"><a href="#跨文档消息传递" class="headerlink" title="跨文档消息传递"></a>跨文档消息传递</h2><blockquote>
<p>postMessage传递的消息, 最早只支持字符串, 后来有些浏览器支持了任何数据结构, 但为了保证安全建议<code>JSON.stringify</code>转换为字符串再传递</p>
</blockquote>
<ul>
<li>postMessage(一条消息, 消息接受方来自哪个域的字符串) 发送消息</li>
<li>onmessage(data, origin, source) 接受消息</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">var iframe = document.getElementById(&quot;#ifrmae&quot;);</span><br><span class="line">iframe.postMessage(&quot;some data&quot;, &quot;http://test.com&quot;);</span><br><span class="line"></span><br><span class="line">window.onmessage = function(data, origin, source) &#123;</span><br><span class="line">	console.log(data, origin, source)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="原生拖放"><a href="#原生拖放" class="headerlink" title="原生拖放"></a>原生拖放</h2><h3 id="拖放事件"><a href="#拖放事件" class="headerlink" title="拖放事件"></a>拖放事件</h3><ul>
<li>dragstart</li>
<li>drag</li>
<li>dragend</li>
</ul>
<blockquote>
<p>当元素拖动到另一个有效的放置目标上时, 会触发以下事件</p>
</blockquote>
<ul>
<li>dragenter</li>
<li>dragover</li>
<li>dragleave 或 drop</li>
</ul>
<h3 id="自定义放置目标"><a href="#自定义放置目标" class="headerlink" title="自定义放置目标"></a>自定义放置目标</h3><blockquote>
<p>元素默认是不允许放置的, 可用阻止默认事件来允许放置</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">droptarget.ondragover = function(event) &#123;</span><br><span class="line">	event.preventDefault();</span><br><span class="line">&#125;</span><br><span class="line">droptarget.ondragenter = function(event) &#123;</span><br><span class="line">	event.preventDefault();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="dataTransfer-对象"><a href="#dataTransfer-对象" class="headerlink" title="dataTransfer 对象"></a>dataTransfer 对象</h3><blockquote>
<p>在触发拖放事件时, 可以通过这个对象读取或者设置数据</p>
</blockquote>
<ul>
<li>dataTransfer.setData(text/URL, ‘str’);</li>
<li>dataTransfer.getData(text/URL)</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">event.dataTransfer.setData(&quot;text&quot;, &quot;some text&quot;);</span><br><span class="line">var text = event.dataTransfer.getData(&quot;text&quot;);</span><br><span class="line"></span><br><span class="line">event.dataTransfer.setData(&quot;URL&quot;, &quot;http://test.com&quot;);</span><br><span class="line">var url = event.dataTransfer.getData(&quot;URL&quot;);</span><br><span class="line"></span><br><span class="line">// 为了浏览器兼容 已写成如下</span><br><span class="line">var dataTransfer = event.dataTransfer;</span><br><span class="line">var url = dataTransfer.getData(&quot;url&quot;) || dataTransfer.getData(&quot;text/uri-list&quot;);</span><br><span class="line">var text = dataTransfer.getData(&quot;Text&quot;);</span><br></pre></td></tr></table></figure>
<h3 id="dropEffect-与-effectAllowed"><a href="#dropEffect-与-effectAllowed" class="headerlink" title="dropEffect 与 effectAllowed"></a>dropEffect 与 effectAllowed</h3><p><img src="https://img.alicdn.com/tfs/TB1Zg9sa_ZRMeJjSspkXXXGpXXa-1992-1412.png" alt="dropEffect 与 effectAllowed"></p>
<h3 id="可拖动"><a href="#可拖动" class="headerlink" title="可拖动"></a>可拖动</h3><blockquote>
<p>设置<code>draggable=&quot;true&quot;</code></p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;div style=&quot;width: 100px;height: 100px;background-color:red;&quot; draggable=&quot;true&quot;&gt;&lt;/div&gt;</span><br></pre></td></tr></table></figure>
<h3 id="其他成员"><a href="#其他成员" class="headerlink" title="其他成员"></a>其他成员</h3><p><img src="https://img.alicdn.com/tfs/TB1YLiBa3MPMeJjy1XbXXcwxVXa-1938-1418.png" alt="其他成员方法"></p>
<h2 id="媒体元素"><a href="#媒体元素" class="headerlink" title="媒体元素"></a>媒体元素</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">//视频</span><br><span class="line">&lt;video src=&quot;video.mpg&quot;&gt;&lt;/video&gt;</span><br><span class="line">//音频</span><br><span class="line">&lt;audio src=&quot;song.mp3&quot;&gt;&lt;/audio&gt;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>不是所有浏览器都支持所有格式 可以使用<code>&lt;source&gt;</code></p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;video&gt;</span><br><span class="line">	&lt;source src=&quot;video.webm&quot; type=&quot;video/webm&quot;&gt;</span><br><span class="line">	&lt;source src=&quot;video.ogv&quot; type=&quot;video/ogg&quot;&gt;</span><br><span class="line">&lt;/video&gt;</span><br></pre></td></tr></table></figure>
<h3 id="属性"><a href="#属性" class="headerlink" title="属性"></a>属性</h3><p><img src="https://img.alicdn.com/tfs/TB1nzyya.gQMeJjy0FiXXXhqXXa-1408-1478.png" alt="属性"></p>
<h3 id="事件"><a href="#事件" class="headerlink" title="事件"></a>事件</h3><p><img src="https://img.alicdn.com/tfs/TB1WR9Da3MPMeJjy1XbXXcwxVXa-1448-1310.png" alt="事件"></p>
<h2 id="历史状态管理"><a href="#历史状态管理" class="headerlink" title="历史状态管理"></a>历史状态管理</h2><blockquote>
<p>现在很多页面都是利用hashchange事件, 改变页面, 所以我们可以通过监听此事件, 向history添加历史, 这样历史的前进和后退又可以用了</p>
</blockquote>
<ul>
<li>history.pushState(状体对象, 新状态的标题, 可选的相对url) 添加历史</li>
<li>history.popstate() 后退</li>
<li>history.replaceState(状体对象, 新状态的标题) 更新替换</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://blog.hellolc.com/2017/08/31/HTML5脚本编程/" data-id="cl7e5jffe000cdo5w1n3cisi7" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javaScript高级程序设计笔记/">javaScript高级程序设计笔记</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-canvas绘图" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/08/21/canvas绘图/" class="article-date">
  <time datetime="2017-08-21T01:41:45.000Z" itemprop="datePublished">2017-08-21</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/08/21/canvas绘图/">canvas基本用法</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="基本用法"><a href="#基本用法" class="headerlink" title="基本用法"></a>基本用法</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;canvas id=&quot;drawing&quot; width=&quot;200&quot; height=&quot;200&quot;&gt;&lt;/canvas&gt;</span><br><span class="line"></span><br><span class="line">var drawing = document.getElementById(&quot;drawing&quot;);</span><br><span class="line">if (drawing.getContext) &#123;</span><br><span class="line">	var ctx = drawing.getContext(&quot;2d&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>toDataUrl(MIME类型格式) 可以将canvas导出为图片</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">var drawing = document.getElementById(&quot;drawing&quot;);</span><br><span class="line">if (drawing.getContext) &#123;</span><br><span class="line">	var imgUrl = drawing.toDataUrl(&quot;image/png&quot;);</span><br><span class="line">	var image = document.createElment(&quot;img&quot;);</span><br><span class="line">	image.src = imgUrl;</span><br><span class="line">	document.body.appendChild(image);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="2D上下文"><a href="#2D上下文" class="headerlink" title="2D上下文"></a>2D上下文</h2><h3 id="填充和描边"><a href="#填充和描边" class="headerlink" title="填充和描边"></a>填充和描边</h3><ul>
<li>strokeStyle 描边颜色</li>
<li>fillStyle 填充颜色</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">var drawing = document.getElementById(&quot;drawing&quot;);</span><br><span class="line">if (drawing.getContext) &#123;</span><br><span class="line">	var ctx = drawing.getContext(&quot;2d&quot;);</span><br><span class="line">	ctx.strokeStyle = &apos;red&apos;;</span><br><span class="line">	ctx.fillStyle = &apos;#ccc&apos;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="绘制矩形"><a href="#绘制矩形" class="headerlink" title="绘制矩形"></a>绘制矩形</h3><blockquote>
<p>fillRect(), strokeRect(), clearRect() 都支持4个参数, 矩形的x坐标, 矩形y坐标, 矩形的宽度, 矩形的高度</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">var drawing = document.getElementById(&quot;drawing&quot;);</span><br><span class="line">if (drawing.getContext) &#123;</span><br><span class="line">	var ctx = drawing.getContext(&quot;2d&quot;);</span><br><span class="line">	//先指定描边颜色</span><br><span class="line">	ctx.strokeStyle = &apos;red&apos;;</span><br><span class="line">	//再执行描边区域</span><br><span class="line">	ctx.strokeRect(10, 10, 50, 50);</span><br><span class="line"></span><br><span class="line">	//先指定填充颜色</span><br><span class="line">	ctx.fillStyle = &apos;#ccc&apos;;</span><br><span class="line">	//在执行填充区域</span><br><span class="line">	ctx.fillRect(100, 100, 50, 50);</span><br><span class="line"></span><br><span class="line">	//清楚画布</span><br><span class="line">	ctx.clearRect(10, 10, 150, 150);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="绘制路径"><a href="#绘制路径" class="headerlink" title="绘制路径"></a>绘制路径</h3><blockquote>
<p>必须先调用<code>beginPath()</code>方法, 表示要开始绘制新路径</p>
</blockquote>
<ul>
<li>arc(x, y, radius, 开始弧度, 结束弧度, 是否逆时针) 以(x, y)为中心绘制弧线</li>
<li>arcTo(x1, y2, x2, y2, radius) 从上一个点开始绘制一条弧线, 到(x2, y2)为止, 并且以给定的半径radius穿过(x1, y1)</li>
<li>bezierCurveTo(c1x, c1y, c2x, c2y, x, y); 从上一个点开始绘制一条比萨尔曲线到(x, y), 并且趋向于(c1x, c1y)和(c2x, c2y)</li>
<li>lineTo(x, y) 从上一点到(x, y)绘制一条直线</li>
<li>moveTo(x, y) 将绘制游标移动到(x, y) 不画线</li>
<li>quadraticCurveTo(cx, cy, x, y) 从上一点开始绘制一条二次曲线, 到(x, y)为止, 并以(cx, cy) 为控制点</li>
<li>rect(x, y, width, height) 绘制一个矩形路径, 与fillRect和strokeRect有区别, 这两者是独立的图形</li>
<li>isPointInPath(x, y) 在路径被关闭前可以用此方法来判断点是否在路径上</li>
</ul>
<blockquote>
<p>绘制好路径后, 如果想绘制一条链接到路径起点的线条, 可以调用 <code>closePath()</code>; 如果想填充路径, 可以调用<code>fill()</code>方法, 可以调用<code>stroke()</code>方法描边, 最后可以调用<code>clip()</code>, 这个方法可以在路径上创建一个剪切区域</p>
</blockquote>
<h3 id="绘制文本"><a href="#绘制文本" class="headerlink" title="绘制文本"></a>绘制文本</h3><ul>
<li>fillText(要绘制的文本字符串, x坐标, y坐标, 最大像素宽度)</li>
<li>strokeText(要绘制的文本字符串, x坐标, y坐标, 最大像素宽度)</li>
<li>font</li>
<li>textAlign</li>
<li>textBaseline 文本基线</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ctx.font = &apos;bold 14px Arial&apos;;</span><br><span class="line">ctx.textAlign = &apos;center&apos;;</span><br><span class="line">ctx.textBaseline = &apos;middle&apos;;</span><br><span class="line">ctx.fillText(&quot;xx&quot;, 100, 20);</span><br></pre></td></tr></table></figure>
<h3 id="变化"><a href="#变化" class="headerlink" title="变化"></a>变化</h3><ul>
<li>rotate(angle) 围绕原点逆时针旋转图像angle弧度</li>
<li>scale(scaleX, scaleY) 缩放图像</li>
<li>translate(x, y) 将坐标原点移动到(x, y); 执行变化后, 坐标(0, 0)会变成之前由(x, y)表示的点</li>
<li>transform(m1_1, m1_2, m2_1, m2_2, dx, dy) 直接修改变化矩阵, 方式乘以如下矩阵<br>m1_1 m1_2 dx<br>m2_1 m2_2 dy<br>0    0    1</li>
<li>setTransform(m1_1, m1_2, m2_1, m2_2, dx, dy) 将变化矩阵重置为默认状态, 然后再调用transform()</li>
</ul>
<blockquote>
<p>fillStyle strokeStyle等属性, 如果不被修改, 在上下文中一直有效; 如果修改后, 想恢复刚才的上下文, 我们可以在修改前, 只有<code>save</code>方法把刚才的上下文推到<code>save</code>堆栈里, 需要恢复的时候再调用<code>restore</code>弹栈恢复</p>
</blockquote>
<ul>
<li>save() </li>
<li>restore()</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">document.body.innerHTML = `&lt;canvas id=&quot;canvas&quot; widht=&quot;500&quot; height=&quot;500&quot; &gt;&lt;/canvas&gt;`</span><br><span class="line">var canvas = document.getElementById(&quot;canvas&quot;);</span><br><span class="line">var ctx = canvas.getContext(&apos;2d&apos;);</span><br><span class="line">ctx.fillStyle = &apos;#ff0000&apos;</span><br><span class="line">ctx.save();</span><br><span class="line">ctx.fillStyle = &apos;#00ff00&apos;;</span><br><span class="line">ctx.translate(100, 100);</span><br><span class="line">ctx.save();</span><br><span class="line">ctx.fillStyle = &apos;#0000ff&apos;;</span><br><span class="line">ctx.fillRect(0, 0, 100, 200);</span><br><span class="line">ctx.restore();</span><br><span class="line">ctx.fillRect(10, 10, 100, 200);</span><br><span class="line">ctx.restore();</span><br></pre></td></tr></table></figure>
<h3 id="绘制图像"><a href="#绘制图像" class="headerlink" title="绘制图像"></a>绘制图像</h3><ul>
<li>drwaImage(图片资源, 起点x, 起点y, [绘制宽度, 绘制高度, …]) 总共可传9个参数, 可以控制截取源目标图片大小和区域, 在指定位置, 展现指定大小</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var image = document.images[0];</span><br><span class="line">ctx.drwaImage(image, 10, 10)</span><br></pre></td></tr></table></figure>
<h3 id="阴影"><a href="#阴影" class="headerlink" title="阴影"></a>阴影</h3><ul>
<li>shadowColor</li>
<li>shadowOffsetX</li>
<li>shadowOffsetY</li>
<li>shadowBlur</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">document.body.innerHTML = `&lt;canvas id=&quot;canvas&quot; widht=&quot;500&quot; height=&quot;500&quot; &gt;&lt;/canvas&gt;`</span><br><span class="line">var canvas = document.getElementById(&quot;canvas&quot;);</span><br><span class="line">var ctx = canvas.getContext(&apos;2d&apos;);</span><br><span class="line">ctx.shadowColor = &apos;#ccc&apos;;</span><br><span class="line">ctx.shadowOffsetX = 5;</span><br><span class="line">ctx.shadowOffsetY = 5;</span><br><span class="line">ctx.shadowBlur = 4;</span><br><span class="line">ctx.fillStyle = &apos;#ff0000&apos;;</span><br><span class="line">ctx.fillRect(10, 10, 50, 50)</span><br></pre></td></tr></table></figure>
<h3 id="渐变"><a href="#渐变" class="headerlink" title="渐变"></a>渐变</h3><ul>
<li>createLinearGradient(起点x, 起点y, 终点x, 终点y)</li>
<li>addColorStop([0-1], 颜色)</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">document.body.innerHTML = `&lt;canvas id=&quot;canvas&quot; widht=&quot;500&quot; height=&quot;500&quot; &gt;&lt;/canvas&gt;`</span><br><span class="line">var canvas = document.getElementById(&quot;canvas&quot;);</span><br><span class="line">var ctx = canvas.getContext(&apos;2d&apos;);</span><br><span class="line">var gradient = ctx.createLinearGradient(30, 30, 70, 70);</span><br><span class="line">gradient.addColorStop(0, &apos;white&apos;)</span><br><span class="line">gradient.addColorStop(1, &apos;black&apos;)</span><br><span class="line">ctx.fillStyle = gradient;</span><br><span class="line">ctx.fillRect(30, 30, 50, 50)</span><br></pre></td></tr></table></figure>
<ul>
<li>createRadialGradient(x1, y1, r1, x2, y2, r2)</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">document.body.innerHTML = `&lt;canvas id=&quot;canvas&quot; widht=&quot;500&quot; height=&quot;500&quot; &gt;&lt;/canvas&gt;`</span><br><span class="line">var canvas = document.getElementById(&quot;canvas&quot;);</span><br><span class="line">var ctx = canvas.getContext(&apos;2d&apos;);</span><br><span class="line">var gradient = ctx.createRadialGradient(30, 30, 10, 30, 30, 30);</span><br><span class="line">gradient.addColorStop(0, &apos;white&apos;)</span><br><span class="line">gradient.addColorStop(1, &apos;black&apos;)</span><br><span class="line">ctx.fillStyle = gradient;</span><br><span class="line">ctx.fillRect(0, 0, 60, 60)</span><br></pre></td></tr></table></figure>
<h3 id="模式"><a href="#模式" class="headerlink" title="模式"></a>模式</h3><ul>
<li>createPartern(img元素/video元素/其他canvas, repeat/no-repeat/repeat-x/repeat-y)</li>
</ul>
<h3 id="使用图像数据"><a href="#使用图像数据" class="headerlink" title="使用图像数据"></a>使用图像数据</h3><ul>
<li>getImageData(x, y, width, height)</li>
<li>putImageData(imageData, x, y)</li>
</ul>
<h3 id="合成"><a href="#合成" class="headerlink" title="合成"></a>合成</h3><ul>
<li>globalAlpha 值0-1, 指定绘制的透明度</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">document.body.innerHTML = `&lt;canvas id=&quot;canvas&quot; widht=&quot;500&quot; height=&quot;500&quot; &gt;&lt;/canvas&gt;`</span><br><span class="line">var canvas = document.getElementById(&quot;canvas&quot;);</span><br><span class="line">var ctx = canvas.getContext(&apos;2d&apos;);</span><br><span class="line"></span><br><span class="line">ctx.globalAlpha = 0.5</span><br><span class="line"></span><br><span class="line">var gradient = ctx.createRadialGradient(30, 30, 10, 30, 30, 30);</span><br><span class="line">gradient.addColorStop(0, &apos;white&apos;)</span><br><span class="line">gradient.addColorStop(1, &apos;black&apos;)</span><br><span class="line">ctx.fillStyle = gradient;</span><br><span class="line">ctx.fillRect(0, 0, 60, 60)</span><br></pre></td></tr></table></figure>
<ul>
<li>globalCompositeOperation 表示绘制的图形怎么和先绘制的图形结合 其值如下<br><img src="https://img.alicdn.com/tfs/TB10aVaXgoQMeJjy0FpXXcTxpXa-1944-1444.png" alt="对应的值"></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">document.body.innerHTML = `&lt;canvas id=&quot;canvas&quot; widht=&quot;500&quot; height=&quot;500&quot; &gt;&lt;/canvas&gt;`</span><br><span class="line">var canvas = document.getElementById(&quot;canvas&quot;);</span><br><span class="line">var ctx = canvas.getContext(&apos;2d&apos;);var gradient = ctx.createLinearGradient(30, 30, 70, 70);</span><br><span class="line">gradient.addColorStop(0, &apos;white&apos;)</span><br><span class="line">gradient.addColorStop(1, &apos;black&apos;)</span><br><span class="line">ctx.fillStyle = gradient;</span><br><span class="line">ctx.fillRect(30, 30, 50, 50)</span><br><span class="line"></span><br><span class="line">ctx.globalCompositeOperation = &apos;destination-over&apos;</span><br><span class="line"></span><br><span class="line">var gradient = ctx.createRadialGradient(30, 30, 10, 30, 30, 30);</span><br><span class="line">gradient.addColorStop(0, &apos;white&apos;)</span><br><span class="line">gradient.addColorStop(1, &apos;black&apos;)</span><br><span class="line">ctx.fillStyle = gradient;</span><br><span class="line">ctx.fillRect(0, 0, 60, 60)</span><br></pre></td></tr></table></figure>
<h2 id="WebGL"><a href="#WebGL" class="headerlink" title="WebGL"></a>WebGL</h2><h3 id="类型化数组"><a href="#类型化数组" class="headerlink" title="类型化数组"></a>类型化数组</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">var buffer = new ArrayBuffer(20);</span><br><span class="line">// 获取大小字节</span><br><span class="line">var bytes = buffer.byteLength;</span><br></pre></td></tr></table></figure>
<h4 id="视图"><a href="#视图" class="headerlink" title="视图"></a>视图</h4><ul>
<li>DataView(buffer, 开始位置, 要选字节数)</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">var buffer = new ArrayBuffer(20);</span><br><span class="line"></span><br><span class="line">//基于整个缓冲器创建一个视图</span><br><span class="line">var view = new DataView(buffer)</span><br><span class="line"></span><br><span class="line">//创建一个从字节9开始的视图</span><br><span class="line">var view = new DataView(buffer, 9)</span><br><span class="line"></span><br><span class="line">//创建一个从字节9开始到18字节的视图</span><br><span class="line">var view = new DataView(buffer, 9, 10)</span><br><span class="line">view.byteOffset; //9</span><br><span class="line">view.byteLength; //10</span><br></pre></td></tr></table></figure>
<ul>
<li>setter和getter方法 第一个参数是一个字节偏移量, 最后一个参数是布尔值, 表示数据的最低有效位是否保存在高内存地址中<br><img src="https://img.alicdn.com/tfs/TB1.8IrXgoQMeJjy1XaXXcSsFXa-1802-1362.png" alt="getter和setter方法"></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">var buffer = new ArrayBuffer(20);</span><br><span class="line">var view = new DataView(buffer)</span><br><span class="line">view.setUnit16(0, 25);</span><br><span class="line">view.setUnit16(2, 50); //只能从2开始 因为16位占2个字节</span><br><span class="line">view.getUnit8(0);//0</span><br><span class="line">view.getUnit8(1);//25</span><br><span class="line">view.getUnit16(0);//25 一个性取2位, 以0位为高位 00000000 00011001</span><br><span class="line">view.getUnit16(1);//6400 因为它以1位为高位 00011001 00000000</span><br><span class="line"></span><br><span class="line">view.setUnit16(0, 25, true);</span><br><span class="line">view.getUnit8(0);//25</span><br><span class="line">view.getUnit8(1);//0</span><br></pre></td></tr></table></figure>
<h4 id="类型化视图"><a href="#类型化视图" class="headerlink" title="类型化视图"></a>类型化视图</h4><ul>
<li>类型化数组 第一个参数为ArrayBuffer对象, 第二个参数为起点字节偏移量, 第三个参数包含的字节数<br><img src="https://img.alicdn.com/tfs/TB1UFsBXogQMeJjy0FiXXXhqXXa-796-462.png" alt="类型化数组"></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">var buffer = new ArrayBuffer(20);</span><br><span class="line">var int8s = new Int8Array(buffer)</span><br><span class="line">//从字节4开始</span><br><span class="line">var int16s = new Int16Array(buffer, 4)</span><br><span class="line">//从字节4到8字节</span><br><span class="line">var int16s = new Uint16Array(buffer, 4, 5)</span><br></pre></td></tr></table></figure>
<ul>
<li>不用先创建ArrayBuffer</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">//创建10个8位整数(10字节)</span><br><span class="line">var int8s = new Int8Array(10)</span><br><span class="line">//创建10个16位整数(20字节)</span><br><span class="line">var int8s = new Int16Array(10)</span><br><span class="line"></span><br><span class="line">//直接创建一个数组 保存4个8位整数</span><br><span class="line">var int8s = new Int8Array([1, 2, 3, 4]) //[1, 2, 3, 4]</span><br><span class="line">//越界</span><br><span class="line">var int8s = new Int8Array([1, 2, 129, 4])// [1, 2, -127, 4]</span><br></pre></td></tr></table></figure>
<ul>
<li>subarray(开始元素的索引, 可选的结束索引) 基于底层数组缓冲器的子集创建一个新视图</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var u = new Int16Array(10)</span><br><span class="line">u.subarray(2, 5)</span><br></pre></td></tr></table></figure>
<h4 id="webgl上下文"><a href="#webgl上下文" class="headerlink" title="webgl上下文"></a>webgl上下文</h4><ul>
<li>getContext(“webgl”, 参数如下)</li>
</ul>
<p><img src="https://img.alicdn.com/tfs/TB1xr3vXmFRMKJjy0FhXXX.xpXa-1818-518.png" alt="webgl参数"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">document.body.innerHTML = `&lt;canvas id=&quot;canvas&quot; widht=&quot;500&quot; height=&quot;500&quot; &gt;&lt;/canvas&gt;`</span><br><span class="line">var canvas = document.getElementById(&quot;canvas&quot;);</span><br><span class="line">var gl = canvas.getContext(&quot;webgl&quot;, &#123;alpha: false&#125;)</span><br></pre></td></tr></table></figure>
<h4 id="准备绘图"><a href="#准备绘图" class="headerlink" title="准备绘图"></a>准备绘图</h4><blockquote>
<p>先用实色清除cavas, 为绘图做准备</p>
</blockquote>
<ul>
<li>clearColor(r, g, b, o) 每个参数的值在0-1之间</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">document.body.innerHTML = `&lt;canvas id=&quot;canvas&quot; widht=&quot;500&quot; height=&quot;500&quot; &gt;&lt;/canvas&gt;`</span><br><span class="line">var canvas = document.getElementById(&quot;canvas&quot;);</span><br><span class="line">var gl = canvas.getContext(&apos;webgl&apos;);</span><br><span class="line">//设置颜色</span><br><span class="line">gl.clearColor(0, 0, 0, 1)</span><br><span class="line">//使用上面定义的颜色清楚</span><br><span class="line"></span><br><span class="line">#### 视口与坐标</span><br><span class="line"></span><br><span class="line">&gt; 视口坐标定义是以左下角为坐标原点; 视口内部的坐标系是以中心为原点, 右上是(1, 1), 左下为(-1, -1)</span><br><span class="line"></span><br><span class="line">- viewport(x, y, width, height)</span><br><span class="line">gl.clear(gl.COLOR_BUFFER_BIT)</span><br></pre></td></tr></table></figure>
<h4 id="缓冲区"><a href="#缓冲区" class="headerlink" title="缓冲区"></a>缓冲区</h4><blockquote>
<p>顶点信息保存在JavaScript的类型化数组中, 使用之前必须先转换到WebGL的缓冲区; 在页面重载之前, 缓冲区始终保持在内存中, 或是调用<code>gl.deleteBuffer(buffer)</code>释放内存</p>
</blockquote>
<ul>
<li>bufferData 最后一个参数如下<ul>
<li>gl.STATIC_DRAW 数据只加载一次, 在多次绘图中使用</li>
<li>gl.STREAM_DRAW 数据只加载一次, 在几次绘图中使用</li>
<li>gl.DYNAMIC_DRAW 数据动态改变, 在多次绘图中使用</li>
</ul>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">var buffer = gl.createBuffer();</span><br><span class="line">//将buffer与webgl上下文绑定</span><br><span class="line">gl.bindBuffer(gl.ARRAY_BUFFER, buffer);</span><br><span class="line">gl.bufferData(gl.ARRAY_BUFFER, new Float32Array([0, 0.5, 1]), gl.STATIC_DRAW);</span><br><span class="line">gl.deleteBuffer(buffer);</span><br></pre></td></tr></table></figure>
<h4 id="错误"><a href="#错误" class="headerlink" title="错误"></a>错误</h4><blockquote>
<p>webgl 不会主动抛出错误, 需要通过<code>getError()</code>方法获取</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var error = gl.getError();</span><br><span class="line">console.log(error)</span><br></pre></td></tr></table></figure>
<h4 id="着色器"><a href="#着色器" class="headerlink" title="着色器"></a>着色器</h4><blockquote>
<p>用的是GLSL语言, 一种类C语言<br>webgl有两种着色器: 顶点着色器和片段着色器 顶点着色器将3D顶点转换为需要渲染的2D. 片段着色器用于准备计算要绘制的每个像素颜色<br>为着色器传递数据的方式有两种: Attribute和Uniform</p>
</blockquote>
<ul>
<li>Attribute 向顶点着色器传入顶点信息</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// 定义了一个类型为vec2的aVertexPosition变量名</span><br><span class="line">attribute vec2 aVertexPosition;</span><br><span class="line">void main() &#123;</span><br><span class="line">	//转换为3D  vec4 表示接受4个值 aVertexPosition是vec2类型 所有算2个值</span><br><span class="line">	gl_position = vec4(aVertexPosition, 0.0, 1.0);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>Uniform 可以向任何着色器传入常量值</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">//</span><br><span class="line">uniform vec4 uColor;</span><br><span class="line">void main() &#123;</span><br><span class="line">	//绘图时的颜色</span><br><span class="line">	gl_FragColor = uColor;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="编写着色器程序"><a href="#编写着色器程序" class="headerlink" title="编写着色器程序"></a>编写着色器程序</h4><blockquote>
<p>因为浏览器不识别GLSL语法, 所以需要将其变成字符串进行转换</p>
</blockquote>
<ul>
<li>gl.createShader(gl.VERTEX_SHADER/gl.FRAGMENT_SHADER)</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">&lt;script type=&quot;x-webgl/x-vertex-shader&quot; id=&quot;vertexShader&quot;&gt;</span><br><span class="line">attribute vec2 aVertexPosition;</span><br><span class="line">void main() &#123;</span><br><span class="line">	//转换为3D  vec4 表示接受4个值 aVertexPosition是vec2类型 所有算2个值</span><br><span class="line">	gl_position = vec4(aVertexPosition, 0.0, 1.0);</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">var vertexShaderText = document.getElementById(&quot;vertexShader&quot;).text;</span><br><span class="line">var vertexShader = gl.createShader(gl.VERTEX_SHADER)</span><br><span class="line">gl.shaderSource(vertexShader, vertexShaderText);</span><br><span class="line">gl.compileShader(vertexShader)</span><br><span class="line"></span><br><span class="line">&lt;script type=&quot;x-webgl/x-fragment-shader&quot; id=&quot;fragmentShader&quot;&gt;</span><br><span class="line">attribute vec2 aVertexPosition;</span><br><span class="line">void main() &#123;</span><br><span class="line">	//转换为3D  vec4 表示接受4个值 aVertexPosition是vec2类型 所有算2个值</span><br><span class="line">	gl_position = vec4(aVertexPosition, 0.0, 1.0);</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">var fragmentShaderText = document.getElementById(&quot;fragmentShader&quot;).text;</span><br><span class="line">var fragmentShader = gl.createShader(gl.FRAGMENT_SHADER)</span><br><span class="line">gl.shaderSource(fragmentShader, fragmentShaderText);</span><br><span class="line">gl.compileShader(fragmentShader)</span><br><span class="line"></span><br><span class="line">//创建程序</span><br><span class="line">var program = gl.createProgram()</span><br><span class="line">gl.attachShader(program, vertexShader);</span><br><span class="line">gl.attachShader(program, fragmentShader);</span><br><span class="line">//将两个对象链接到着色器程序中</span><br><span class="line">gl.linkProgram(program)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//通知webgl使用这个程序</span><br><span class="line">gl.useProgram(program);</span><br></pre></td></tr></table></figure>
<h4 id="为着色器传入值"><a href="#为着色器传入值" class="headerlink" title="为着色器传入值"></a>为着色器传入值</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">//找到内存地址</span><br><span class="line">var uColor = gl.getUniformLocation(program, &quot;uColor&quot;);</span><br><span class="line">//给uColor赋值</span><br><span class="line">gl.uniform4fv(uColor, [0, 0, 0, 1]);</span><br><span class="line"></span><br><span class="line">//找到attribute在内存中的位置</span><br><span class="line">var aVertexPosition = gl.getAttribLocation(program, &quot;aVertexPosition&quot;);</span><br><span class="line">//启用</span><br><span class="line">gl.enableVertexAttribArray(aVertexPosition);</span><br><span class="line">//创建指针, 指向gl.bindBuffer()指定的缓冲区, 并将其保存在aVertexPosition中, 以便顶点着色器使用</span><br><span class="line">gl.vertextAttribPointer(aVertexPosition, itemSize, gl.FLOAT, false, 0 , 0);</span><br></pre></td></tr></table></figure>
<h4 id="调试着色器和程序"><a href="#调试着色器和程序" class="headerlink" title="调试着色器和程序"></a>调试着色器和程序</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">//编译成功返回true 否则返回false</span><br><span class="line">if (! gl.getShaderParameter(vertexShader, gl.COMPILE_STATUS)) &#123;</span><br><span class="line">	//获取错误信息</span><br><span class="line">	alert(gl.getShaderInfoLog(vertexShader));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="绘图"><a href="#绘图" class="headerlink" title="绘图"></a>绘图</h4><blockquote>
<p>webgl只能绘制3种形状: 点, 线和三角</p>
</blockquote>
<ul>
<li>gl.drawArrays() 数组缓冲区</li>
<li>gl.drawElements 元素数组缓冲区<br><img src="https://img.alicdn.com/tfs/TB1IRGuawoQMeJjy0FnXXb8gFXa-2022-1360.png" alt="第一个参数选项"></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=&quot;en&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">	&lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">	&lt;title&gt;Document&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">	&lt;canvas id=&quot;canvas&quot; widht=&quot;500&quot; height=&quot;500&quot; &gt;&lt;/canvas&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;script type=&quot;x-webgl/x-vertex-shader&quot; id=&quot;vertexShader&quot;&gt;</span><br><span class="line">attribute vec2 aVertexPosition;</span><br><span class="line">void main() &#123;</span><br><span class="line">	//转换为3D  vec4 表示接受4个值 aVertexPosition是vec2类型 所有算2个值</span><br><span class="line">	gl_position = vec4(aVertexPosition, 0.0, 1.0);</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;script type=&quot;x-webgl/x-fragment-shader&quot; id=&quot;fragmentShader&quot;&gt;</span><br><span class="line">attribute vec2 aVertexPosition;</span><br><span class="line">void main() &#123;</span><br><span class="line">	//转换为3D  vec4 表示接受4个值 aVertexPosition是vec2类型 所有算2个值</span><br><span class="line">	gl_position = vec4(aVertexPosition, 0.0, 1.0);</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;script type=&quot;text/javascript&quot;&gt;</span><br><span class="line">var canvas = document.getElementById(&quot;canvas&quot;);</span><br><span class="line">var gl = canvas.getContext(&apos;webgl&apos;);</span><br><span class="line">var vertexShaderText = document.getElementById(&quot;vertexShader&quot;).text;</span><br><span class="line">var vertexShader = gl.createShader(gl.VERTEX_SHADER)</span><br><span class="line">gl.shaderSource(vertexShader, vertexShaderText);</span><br><span class="line">gl.compileShader(vertexShader)</span><br><span class="line"></span><br><span class="line">var fragmentShaderText = document.getElementById(&quot;fragmentShader&quot;).text;</span><br><span class="line">var fragmentShader = gl.createShader(gl.FRAGMENT_SHADER)</span><br><span class="line">gl.shaderSource(fragmentShader, fragmentShaderText);</span><br><span class="line">gl.compileShader(fragmentShader)</span><br><span class="line"></span><br><span class="line">//创建程序</span><br><span class="line">var program = gl.createProgram()</span><br><span class="line">gl.attachShader(program, vertexShader);</span><br><span class="line">gl.attachShader(program, fragmentShader);</span><br><span class="line">//将两个对象链接到着色器程序中</span><br><span class="line">gl.linkProgram(program)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//通知webgl使用这个程序</span><br><span class="line">gl.useProgram(program);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">var vertices = new Float32Array([0, 1, 1, -1, -1, -1]),</span><br><span class="line">buffer = gl.createBuffer(),</span><br><span class="line">vertexSetSize = 2,</span><br><span class="line">vertexSetCount = vertices.length / vertexSetSize,</span><br><span class="line">uColor, aVertexPosition;</span><br><span class="line"></span><br><span class="line">//数据放到缓冲区</span><br><span class="line">gl.bindBuffer(gl.ARRAY_BUFFER, buffer);</span><br><span class="line">gl.bufferData(gl.ARRAY_BUFFER, vertices, gl.STATIC_DRAW);</span><br><span class="line"></span><br><span class="line">//为片段着色器传入颜色值</span><br><span class="line">uColor = gl.getUniformLocation(program, &quot;uColor&quot;);</span><br><span class="line">gl.uniform4fv(uColor, [0, 0, 0, 1]);</span><br><span class="line"></span><br><span class="line">//为着色器传入顶点信息</span><br><span class="line">aVertexPosition = gl.getAttribLocation(program, &quot;aVertexPosition&quot;);</span><br><span class="line">gl.enableVertexAttribArray(aVertexPosition);</span><br><span class="line">gl.vertexAttribPointer(aVertexPosition, vertexSetSize, gl.FLOAT, false, 0, 0);</span><br><span class="line"></span><br><span class="line">//绘制三角形</span><br><span class="line">gl.drawArrays(gl.TRIANGLES, 0, vertexSetCount);</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://blog.hellolc.com/2017/08/21/canvas绘图/" data-id="cl7e5jfgi0024do5w1aijdx6c" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javaScript高级程序设计笔记/">javaScript高级程序设计笔记</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-事件" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/08/09/事件/" class="article-date">
  <time datetime="2017-08-09T02:12:50.000Z" itemprop="datePublished">2017-08-09</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/08/09/事件/">事件</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="事件流"><a href="#事件流" class="headerlink" title="事件流"></a>事件流</h2><h3 id="DOM事件流"><a href="#DOM事件流" class="headerlink" title="DOM事件流"></a>DOM事件流</h3><blockquote>
<p>DOM2级事件规定事件流包括三个阶段: 事件捕获阶段, 处于目标阶段和事件冒泡阶段. IE9+的等浏览器都支持此事件流</p>
</blockquote>
<h2 id="事件处理程序"><a href="#事件处理程序" class="headerlink" title="事件处理程序"></a>事件处理程序</h2><h3 id="DOM0级事件处理程序"><a href="#DOM0级事件处理程序" class="headerlink" title="DOM0级事件处理程序"></a>DOM0级事件处理程序</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">var div = document.getElementById(&quot;div1&quot;);</span><br><span class="line">div.onclick = function() &#123;</span><br><span class="line">	console.log(this.id);//div1</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">div.onclick = null;//删除事件</span><br></pre></td></tr></table></figure>
<h3 id="DOM2级事件处理程序"><a href="#DOM2级事件处理程序" class="headerlink" title="DOM2级事件处理程序"></a>DOM2级事件处理程序</h3><ul>
<li>addEventListener(要处理的事件名, 作为事件处理的函数, 是否捕捉);</li>
<li>removeEventListener(要处理的事件名, 作为事件处理的函数, 是否捕捉);</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">var div = document.getElementById(&quot;div1&quot;); </span><br><span class="line">var handler = function() &#123;</span><br><span class="line">	//do something</span><br><span class="line">&#125;</span><br><span class="line">div.addEventListener(&apos;click&apos;, handler, false);</span><br><span class="line">div.removeEventListener(&apos;click&apos;, handler, false);</span><br></pre></td></tr></table></figure>
<h3 id="IE事件处理程序"><a href="#IE事件处理程序" class="headerlink" title="IE事件处理程序"></a>IE事件处理程序</h3><ul>
<li>attachEvent(事件处理名称, 事件处理函数)</li>
<li>detachEvent(事件处理名称, 事件处理函数)</li>
</ul>
<blockquote>
<p><code>attachEvent</code>绑定的事件需要添加前缀<code>on</code>, 而<code>addEventListener</code>不需要; 事件处理函数的<code>this</code>指向<code>window</code></p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">var div = document.getElementById(&quot;div1&quot;); </span><br><span class="line">var handler = function() &#123;</span><br><span class="line">	console.log(this === window); //true</span><br><span class="line">&#125;</span><br><span class="line">div.attachEvent(&apos;onclick&apos;, handler);</span><br><span class="line">div.detachEvent(&apos;onclick&apos;, handler);</span><br></pre></td></tr></table></figure>
<h2 id="事件对象"><a href="#事件对象" class="headerlink" title="事件对象"></a>事件对象</h2><h3 id="DOM中的事件"><a href="#DOM中的事件" class="headerlink" title="DOM中的事件"></a>DOM中的事件</h3><blockquote>
<p>只有在事件处理程序执行期间, event对象才会存在, 一旦事件处理程序执行完成, event对象就会被销毁</p>
<p>当我们将事件挂载在body上, 并点击body中的一个按钮btn, 会有如下结果;</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">document.body.onclick = function(event) &#123;</span><br><span class="line">	console.log(event.currentTarget === document.body);//true</span><br><span class="line">	console.log(this === document.body);//true</span><br><span class="line">	console.log(event.target === document.getElementById(&quot;btn&quot;));//true</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>preventDefault() 阻止默认事件</li>
<li>stopPropagation() 阻止事件的捕捉和冒泡</li>
<li>eventPhase 值为 1 是捕捉阶段, 值为2是处于目标对象上, 值为3是冒泡阶段</li>
</ul>
<h3 id="IE中的事件对象"><a href="#IE中的事件对象" class="headerlink" title="IE中的事件对象"></a>IE中的事件对象</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">var btn = document.getElemntById(&apos;btn&apos;);</span><br><span class="line">btn.onclick = function() &#123;</span><br><span class="line">	window.event.type; //click</span><br><span class="line">	window.event.returnValue = false;//阻止默认事件</span><br><span class="line">	window.event.cancelBubble = true;//阻止冒泡事件</span><br><span class="line">	window.event.scrElemnt == this;//true 事件对象</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="事件类型"><a href="#事件类型" class="headerlink" title="事件类型"></a>事件类型</h2><h3 id="UI事件"><a href="#UI事件" class="headerlink" title="UI事件"></a>UI事件</h3><ul>
<li>DOMActivate: 表示元素已被用户操作(通过鼠标或键盘)激活. 这个事件被在dom3级事件废弃, 建议不使用</li>
<li>load: 当页面完全加载后在window上面触发, 当所有框架都加载完毕时在框架集上面触发, 当图像加载完毕时在<img>元素上面触发, 或者嵌入的内容加载完毕时在<code>&lt;object&gt;</code>元素上面触发</li>
<li>unload: 当页面卸载时在window上面触发等, 与load事件对应</li>
<li>abort: 用户停止下载过程时, 如果嵌入的内容没有加载完毕时, 则在<code>&lt;object&gt;</code>元素上面触发</li>
<li>error: 当发生JavaScript错误时在window上触发, 当无法加载图像时在<code>&lt;img&gt;</code>元素上面触发等</li>
<li>select: 用户选择文本框中的字符时触发</li>
<li>resize: 窗口大小变化时触发</li>
<li>scroll: 滚动条滚动时触发</li>
</ul>
<h3 id="焦点事件"><a href="#焦点事件" class="headerlink" title="焦点事件"></a>焦点事件</h3><ul>
<li>focus: 当元素获取焦点时触发, 这个事件不冒泡</li>
<li>focusin: 在元素获取焦点时触发, 这个事件冒泡</li>
<li>blur: 当元素失去焦点时触发, 这个事件不冒泡</li>
<li>focusout: 在元素失去焦点时触发, 是html事件blur的通用版本</li>
</ul>
<blockquote>
<p>当焦点从一个元素移动到另一个元素时, 会依次触发下列事件, 其中focusout blur DOMFocusOut在失去焦点元素上触发, 其他在获取焦点元素上触发</p>
</blockquote>
<ul>
<li>focusout </li>
<li>focusin</li>
<li>blur</li>
<li>DOMFocusOut</li>
<li>focus</li>
<li>DOMFocusIn</li>
</ul>
<h3 id="鼠标事件"><a href="#鼠标事件" class="headerlink" title="鼠标事件"></a>鼠标事件</h3><ul>
<li>click</li>
<li>dbclick</li>
<li>mousedown</li>
<li>mouseenter</li>
<li>mouseleave</li>
<li>mousemove</li>
<li>mouseout</li>
<li>mouseover</li>
<li>mouseup</li>
</ul>
<blockquote>
<p>除了 mouseenterh, mouseleave 不冒泡, 其他都冒泡; 事件间也会有关联; 只有在同一个元素上相继触发mousedown和mouseup才会触发click事件, 取消任何一个事件都不会触发click</p>
</blockquote>
<ol>
<li><p>客户区坐标位置</p>
<ul>
<li>clientX 鼠标在客户区的水平坐标</li>
<li>clientY 鼠标在客户区的垂直坐标</li>
</ul>
</li>
<li><p>页面坐标位置</p>
<ul>
<li>pageX </li>
<li>pageY</li>
</ul>
</li>
</ol>
<blockquote>
<p>此两值与clientX, clientY类似, 只不过从页面本身而不是从视口的左边和定边开始计算的</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pageX = event.clietX + (docuemnt.body.scrollLeft || document.documentElement.scrollLeft);</span><br><span class="line">pageY = event.clietY + (docuemnt.body.scrollTop || document.documentElement.scrollTop);</span><br></pre></td></tr></table></figure>
<ol>
<li><p>屏幕坐标位置</p>
<ul>
<li>screenX 到屏幕最左侧的坐标</li>
<li>screenY 到屏幕最上方的坐标</li>
</ul>
</li>
<li><p>相关元素</p>
</li>
</ol>
<blockquote>
<p>在嵌套的元素里绑定<code>mouseover</code>, <code>mouseout</code>等事件, 会触发多余事件, 我们可以通过判断相关元素, 来避免多余事件触发, IE9+可以使用<code>event.relatedTarget</code>属性判断, ie8及以下使用<code>event.fromElment</code>和<code>event.toElement</code>属性判断 </p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">var EventUtil = &#123;</span><br><span class="line">	getRelatedTarget: function(event) &#123;</span><br><span class="line">		if (event.relatedTarget) &#123;</span><br><span class="line">			return event.relatedTarget;</span><br><span class="line">		&#125; else if (event.toElement) &#123;</span><br><span class="line">			return event.toElement;</span><br><span class="line">		&#125; else if (event.fromElement) &#123;</span><br><span class="line">			return event.fromElement;</span><br><span class="line">		&#125; else &#123;</span><br><span class="line">			return null;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol>
<li>鼠标按钮</li>
</ol>
<blockquote>
<p>当发生<code>mousedown</code>或<code>mouseup</code>事件时, 可以根据<code>event.button</code>来判断按下的是鼠标的哪个键; firefox支持一个<code>DOMMourseScroll</code>事件, 会冒泡到<code>window</code>上</p>
</blockquote>
<ol>
<li>鼠标滚轮事件</li>
</ol>
<blockquote>
<p>滚轮事件<code>mousewheel</code>都会冒泡到<code>document</code>或<code>window</code>上</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$(document).on(&quot;mousewheel&quot;, function(e) &#123;console.log(e.detail)&#125;)</span><br><span class="line">//firefox</span><br><span class="line">$(window).on(&quot;DOMMouseScroll&quot;, function(e) &#123;console.log(&quot;detail:&quot;, e.detail)&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="键盘与文本事件"><a href="#键盘与文本事件" class="headerlink" title="键盘与文本事件"></a>键盘与文本事件</h3><ul>
<li>keydown 任意键都会触发</li>
<li>keypress 只要字符才会触发</li>
<li><p>keyup 当用户释放按键时才触发</p>
</li>
<li><p>获取字符编码</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">var eventUtil = &#123;</span><br><span class="line">	getCharCode: function(event) &#123;</span><br><span class="line">		if (typeof event.charCode == &quot;number&quot;) &#123;</span><br><span class="line">			return event.charCode;</span><br><span class="line">		&#125; else &#123;</span><br><span class="line">			return event.keyCode;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>getModifierState(“Shift/Control/AltGraph/Meta”) 检测是否被按下</li>
<li>textInput事件</li>
</ul>
<blockquote>
<p>只会在可编辑区域触发事件, 与keypress也有区别, keypress在按下影响文本显示时也会触发(比如退格键)</p>
</blockquote>
<ul>
<li>event.inputmethod 表示把文本输入到文本框中的方式, 比如黏贴复制, 拖放, 手写等</li>
</ul>
<h3 id="复合事件"><a href="#复合事件" class="headerlink" title="复合事件"></a>复合事件</h3><blockquote>
<p>可以让用户输入键盘上没有的字符</p>
</blockquote>
<ul>
<li>compositionstart</li>
<li>compositionupdate</li>
<li>compositionend</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//判断是否支持复合事件</span><br><span class="line">document.implementation.hasFeature(&quot;CompositionEvent&quot;, &quot;3.0&quot;)</span><br></pre></td></tr></table></figure>
<h3 id="变动事件"><a href="#变动事件" class="headerlink" title="变动事件"></a>变动事件</h3><ul>
<li>DOMSubtreeModified DOM结构发生任何变化时触发</li>
<li>DOMNodeInserted</li>
<li>DOMNodeRemoved</li>
<li>DOMNodeInsertedIntoDocument 在DOMNodeInserted后触发</li>
<li>DOMNodeRemovedFromDocument 在DOMNodeRemoved后触发</li>
<li>DOMAttrModified </li>
<li>DOMCharacterDataModified 值变化触发</li>
</ul>
<h3 id="HTML5事件"><a href="#HTML5事件" class="headerlink" title="HTML5事件"></a>HTML5事件</h3><ol>
<li>contextmenu 鼠标右击调出上下文事件, 通常可以用来替换右击显示样式</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">var div = document.getElementById(&quot;div&quot;);</span><br><span class="line">div.oncontextmenu = function(e) &#123;</span><br><span class="line">	e.preventDefault();</span><br><span class="line">	//阻止默认显示, 显示自定样式</span><br><span class="line">	var menu = document.getElementById(&quot;menu&quot;);</span><br><span class="line">	menu.style.left = e.clientX + &apos;px&apos;;</span><br><span class="line">	menu.style.top = e.clientY + &apos;px&apos;;</span><br><span class="line">	menu.style.visibility = &apos;visible&apos;;</span><br><span class="line">&#125;</span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">2. beforeunload 关闭页面前提示是否关闭</span><br><span class="line">3. DOMContentLoaded </span><br><span class="line"></span><br><span class="line">&gt; 这个方法与load的事件的区别是: load会等待js, 图片加载完毕, 而这个事件发生在形成完整的DOM树后触发;</span><br><span class="line">对于IE9以前的浏览器不支持此事件, 通过setTimeout(function() &#123;&#125;, 0)实现, 并且作为页面中第一个超时顶用.</span><br><span class="line"></span><br><span class="line">4. readystatechange事件</span><br><span class="line"> - uninitialized(未初始化) 对象未初始化 </span><br><span class="line"> - loading(正在加载) 对象正在加载数据</span><br><span class="line"> - loaded 对象加载数据完毕</span><br><span class="line"> - interactive (交互) 可以操作对象了, 但还没有完全加载 (DOMContentLoaded事件也几乎同时发送在此时)</span><br><span class="line"> - complete(完成) 对象已经加载完成</span><br><span class="line"></span><br><span class="line">&gt; 不是没有对象的加载, 都会有以上阶段, 有些对象会跳过某些阶段</span><br></pre></td></tr></table></figure>
<p>document.onreadystatechange = function(event) {<br>    if (document.readyState == ‘interactive’ || document.readyState == ‘complete’) {<br>        consolelog(‘content loaded’)<br>    }<br>}<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">5. pageshow和pagehide</span><br><span class="line"></span><br><span class="line"> - pageshow 页面显示时触发, 不管是否来自缓存, 会在load事件后触发; 可以通过event.persisted来判断, true为来自缓存</span><br><span class="line"> - pagehide 在页面卸载时触发, 在unload事件前触发</span><br></pre></td></tr></table></figure></p>
<p>window.onpageshow = function(e) {console.log(e.persisted)}<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">6. hashchange事件</span><br></pre></td></tr></table></figure></p>
<p>window.onhashchange = function(event) {<br>    console.log(event.oldURL, event.newURL)<br>}<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">### 设备事件</span><br><span class="line">1. orientationchange 事件, ios设备屏幕旋转时会触发</span><br><span class="line"> - window.orientation值为0, 表示刚好垂直</span><br><span class="line"> - window.orientation值为90, 表示头朝正左边</span><br><span class="line"> - window.orientation值为-90, 表示头朝正右边</span><br></pre></td></tr></table></figure></p>
<p>window.orientationchange = function(event) {<br>    console.log(window.orientation)<br>}<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">2. MozOrientation 事件 安卓 设备支持</span><br></pre></td></tr></table></figure></p>
<p>window.MozOrientation = function(event) {<br>    consoe.log(event.x, event.y, event.y)<br>}<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">3. deviceorientation 事件 与MozOrientation类似  兼容性也是最好的</span><br><span class="line"> - alpha: z轴 0 - 360度</span><br><span class="line"> - beta: x轴 -180 - 180度</span><br><span class="line"> - gamma: y轴 -90 - 90度</span><br><span class="line"> - absolute 布尔值, 表示设备是否返回一个绝对值</span><br><span class="line"> - compassCalibrated 布尔值, 表示指南针是否校准过</span><br><span class="line"></span><br><span class="line">4. devicemotion 事件 可以检测手机是否在往下掉, 是否被拿在手里</span><br><span class="line"> - acceleration: 一个包含x, y, z的对象, 在不考虑重力的情况下, 告诉你在每个方向上的加速度</span><br><span class="line"> - accelerationIncludeingGravity: 一个包含x, y, z的对象, 在考虑重力的情况下, 告诉你在每个方向上的加速度</span><br><span class="line"> - interval 以毫秒表示的时间值</span><br><span class="line"> - rotationRate: 包含alpha, beta, gamma的对象</span><br><span class="line"></span><br><span class="line">### 触摸与手势事件</span><br><span class="line">1. 触摸事件</span><br><span class="line"> - touchstart</span><br><span class="line"> - touchmove</span><br><span class="line"> - touchend</span><br><span class="line"> - touchcanel</span><br><span class="line"></span><br><span class="line">2. 手势事件</span><br><span class="line"> - gesturestart 当一个手指已经按在屏幕上时, 而另一个手指又触摸屏幕时触发</span><br><span class="line"> - gesturechange 当触摸屏幕任何一个手指位置变化时触发</span><br><span class="line"> - gestureend 当任何一个手指从屏幕上移开时触发</span><br><span class="line"></span><br><span class="line">&gt; 只有两个手指都触摸到屏幕上才触发这些事件</span><br><span class="line"></span><br><span class="line">## 内存和性能</span><br><span class="line">### 事件委托</span><br><span class="line">&gt; 当对一个元素的子元素绑定了很多事件的时候, 可以对其父元素利用事件委托的机制绑定, 利用`event.target`判断是哪个子元素, 响应对应的事件, 可以提升性能</span><br><span class="line"></span><br><span class="line">### 移除事件处理程序</span><br><span class="line">&gt; 在ie8以前的浏览器, 当一个元素绑定了事件, 然后这个元素被删除后, 因为还和事件处于引用关系, 因此还在内存中无法释放, 所以应该先取消引用关系, 再删除;</span><br><span class="line">或是把事件委托给父类</span><br></pre></td></tr></table></figure></p>
<p><div div="div"><br>    <button id="btn">按钮</button><br></div><br>var btn = document.getElementById(“btn”);<br>btn.onclick = function(event) {<br>    var div = document.getElementById(“div”);<br>    div.innerHTML = ‘clicked’<br>}</p>
<p>//优化如下<br>btn.onclick = function(event) {<br>    var div = document.getElementById(“div”);<br>    //取消引用关系<br>    btn.onclick = null;<br>    div.innerHTML = ‘clicked’<br>}</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">## 模拟事件</span><br><span class="line">### DOM中的事件模拟</span><br><span class="line">- createEvent(参数)</span><br><span class="line"> + UIEvents 鼠标键盘事件</span><br><span class="line"> + MouseEvents 一般化的鼠标事件</span><br><span class="line"> + MutationEvents 一般化的DOM变动</span><br><span class="line"> + HTMLEvents 一般化的HTML事件</span><br><span class="line"></span><br><span class="line">- dispatchEvent(事件对象) 触发事件</span><br><span class="line"></span><br><span class="line">1. 鼠标事件</span><br><span class="line">&gt; createEvent(&quot;MouseEvents&quot;), 返回对象有个initMouseEvent()方法, 该方法接受如下15个参数</span><br><span class="line"></span><br><span class="line">![鼠标事件参数](https://img.alicdn.com/tfs/TB1KMGzSVXXXXcBXFXXXXXXXXXX-1992-1222.png)</span><br></pre></td></tr></table></figure>
<p>var btn = document.getElementById(“myBtn”);<br>var event = document.createEvent(“MouseEvents”);<br>event.返回对象有个initMouseEvent(“click”, true)<br>event.initMouseEvent(“click”, true, true, document.defaultView, 0, 0, 0, 0, 0, false, false, false, false, 0, null)<br>btn.dispatchEvent(event)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">2. 键盘事件</span><br><span class="line">- createEvent(&quot;keyboardEvent&quot;), 返回对象包含一个initKeyEvent()方法, 可接受如下参数</span><br><span class="line">![鼠标事件参数](https://img.alicdn.com/tfs/TB1UHB_SVXXXXaIapXXXXXXXXXX-2090-788.png)</span><br><span class="line"></span><br><span class="line">3. 模拟其他事件</span><br><span class="line">&gt; createEvent(&quot;MutationEvents&quot;), 返回对象有个initMutationEvent()方法, 可接受参数, type, bubbles, cancelable, relatedNode, preValue, newValue, attrName, attrChange</span><br><span class="line"></span><br><span class="line">&gt; createEvent(&quot;HTMLEvents&quot;), 返回对象有个initEvent()方法</span><br></pre></td></tr></table></figure></p>
<p> var event = docuemnt.createEvent(‘HTMLEvents’);<br> event.initEvent(“focus”, true, true);<br> target.dispatchEvent(event);<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">4. 自定义事件</span><br><span class="line">&gt; createEvent(&quot;CustomEvent&quot;), 返回对象有个initCustomEvent()方法, 接受4个参数, type, bubbles, cancelable, detail(对象, 保存在event对象的detail属性中)</span><br></pre></td></tr></table></figure></p>
<p>event = docuemnt.createEvent(‘CustomEvent’);<br>event.initCustomEvent(“myevent”, true, true, false, “hello world”);<br>target.dispatchEvent(event);<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">### IE中的事件模拟</span><br></pre></td></tr></table></figure></p>
<p>var mtBtn = document.getElementById(“myBtn”)<br>var event = document.createEventObject();<br>event.screenX = 100;<br>event.screenY = 0;<br>event.clientX = 0;<br>event.clientY = 0;<br>event.ctrlKey = false;<br>event.altKey = false;<br>event.shiftKey = false;<br>event.button = 0;</p>
<p>myBtn.fireEvent(“onclick”, event);<br>```</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://blog.hellolc.com/2017/08/09/事件/" data-id="cl7e5jfgr002gdo5w3bj4fp93" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javaScript高级程序设计笔记/">javaScript高级程序设计笔记</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-dom23" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/08/05/dom23/" class="article-date">
  <time datetime="2017-08-05T06:18:55.000Z" itemprop="datePublished">2017-08-05</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/08/05/dom23/">DOM2和DOM3</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="检测DOM等级方法"><a href="#检测DOM等级方法" class="headerlink" title="检测DOM等级方法"></a>检测DOM等级方法</h2><ul>
<li>document.implementation.hasFeature(属性名, 等级)<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">document.implementation.hasFeature(&quot;MouseEvents&quot;, &quot;2.0&quot;);//检测MouseEvents是否支持DOM2.0</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="DOM变化"><a href="#DOM变化" class="headerlink" title="DOM变化"></a>DOM变化</h2><h3 id="document类型的变化"><a href="#document类型的变化" class="headerlink" title="document类型的变化"></a>document类型的变化</h3><ul>
<li>createElementNS(namespaceURI, tagName) 使用给定的tagName创建一个属于命名空间为namespaceURI的新元素</li>
<li>createAtrributeNS(namespaceURI, attributeName) 使用给定的attributeName创建一个属于命名空间namespaceURI的新特性</li>
<li>getElementsByTagNameNS(namespaceURI, tagName) 返回属于命名空间namespaceURI的tagName元素的NodeList</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">var svg = document.createElementNS(&quot;http://www.w3.org/2000/svg&quot;, &quot;svg&quot;);</span><br><span class="line">var attr = document.createAtrributeNS(&quot;http://wwww.somewhere.com&quot;, &quot;random&quot;);</span><br><span class="line">var elements = document.getElementsByTagNameNS(&quot;http://www.w3.org/2000/xhtml&quot;, &quot;*&quot;);</span><br></pre></td></tr></table></figure>
<ul>
<li>importNode(节点对象, 是否深复制) 这个方法功能和cloneNode()非常类似, 使用cloneNode()从别的文档树种拷贝的节点, 会导致错误, 所以使用importNode, 就能保证拷贝过来的新节点的onwerDocuemnt属性, 是指向当前文档树的</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var newNode = document.importNode(oldNode, true);</span><br><span class="line">document.body.appendChild(newNode);</span><br></pre></td></tr></table></figure>
<ul>
<li>document.implementation.createHTMLDocument(新标题) 创建一个完整的html文档</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">var newHtml = document.implementation.createHTMLDocument(&quot;new title&quot;);</span><br><span class="line">newHtml.title; //new title</span><br><span class="line">typeof newHtml.body; //object</span><br></pre></td></tr></table></figure>
<h3 id="Node-类型的变化"><a href="#Node-类型的变化" class="headerlink" title="Node 类型的变化"></a>Node 类型的变化</h3><ul>
<li>isSameNode(比较节点) 节点相同, 同一个对象</li>
<li>isEqualNode(比较节点) 节点相等, 具有相同的属性(nodeName, nodeValue等)</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">var div1 = document.createElement(&quot;div&quot;);</span><br><span class="line">div1.setAttribute(&quot;class&quot;, &quot;box&quot;);</span><br><span class="line"></span><br><span class="line">var div2 = document.createElement(&quot;div&quot;);</span><br><span class="line">div2.setAttribute(&quot;class&quot;, &quot;box&quot;);</span><br><span class="line"></span><br><span class="line">div1.isSameNode(div1);//true</span><br><span class="line">div1.isEqualNode(div2);//true</span><br><span class="line">div1.isSameNode(div2);//false</span><br></pre></td></tr></table></figure>
<ul>
<li>setUserData()将数据指定给节点, 它接受3个参数, 要设置的键, 实际的值(可以是任务数据类型)和处理函数, 处理函数接受5个参数, 分别表示操作类型的数值(1表示复制, 2表示导入, 3表示删除, 4表示重命名), 数据键, 数据值, 源节点和目标节点</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">var div = document.createElement(&quot;div&quot;);</span><br><span class="line">div.setUserData(&quot;name&quot;, &quot;James&quot;, function(operation, key, value, src, desc) &#123;</span><br><span class="line">	if (operation == 1) &#123;</span><br><span class="line">		desc.setUserData(key, value, function() &#123;&#125;)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;);</span><br><span class="line">var newDiv = div.cloneNode(true);</span><br><span class="line">newNode.getUserData(&quot;name&quot;);//James</span><br></pre></td></tr></table></figure>
<h3 id="框架变化"><a href="#框架变化" class="headerlink" title="框架变化"></a>框架变化</h3><ul>
<li>contentDocument 指向表示框架内容的文档对象</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var iframe = document.getElementsById(&quot;myIframe&quot;);</span><br><span class="line">var iframeDoc = iframe.contentDocument || iframe.contentWindow.document;</span><br></pre></td></tr></table></figure>
<h2 id="样式"><a href="#样式" class="headerlink" title="样式"></a>样式</h2><h3 id="访问元素样式"><a href="#访问元素样式" class="headerlink" title="访问元素样式"></a>访问元素样式</h3><ul>
<li>getPropertyCSSValue(propertyName)</li>
<li>getPropertyValue(propertyName)</li>
<li>cssText </li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var myDiv = document.getElementsByTagName(&quot;div&quot;)[0];</span><br><span class="line">myDiv.style.cssText = &quot;font-size: 18px; background-color: red&quot;;</span><br></pre></td></tr></table></figure>
<h3 id="计算的样式"><a href="#计算的样式" class="headerlink" title="计算的样式"></a>计算的样式</h3><ul>
<li><p>getComputedStyle 可以获取其他样式表层叠而来并影响到当前元素的样式信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;style type=&quot;text/css&quot;&gt;</span><br><span class="line">	#myDiv &#123;</span><br><span class="line">		width: 100px;</span><br><span class="line">		height: 100px;</span><br><span class="line">		background-color: blue;</span><br><span class="line">	&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line">&lt;div id=&quot;myDiv&quot; style=&quot;background-color:red;&quot;&gt;&lt;/div&gt;</span><br><span class="line">&lt;script type=&quot;text/javascript&quot;&gt;</span><br><span class="line">	var myDiv = document.getElementById(&quot;#myDiv&quot;);</span><br><span class="line">	var computeStyle = document.defaultView.getComputedStyle(myDiv, null);</span><br><span class="line">	computeStyle.backgroundColor; //red</span><br><span class="line">	computeStyle.width;//100px;</span><br><span class="line">	computeStyle.height;//100px;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>currentStyle IE下使用此属性获取计算后的属性</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">var myDiv = document.getElementById(&quot;#myDiv&quot;);</span><br><span class="line">var currentStyle = myDiv.currentStyle;</span><br><span class="line">currentStyle.backgroundColor;</span><br></pre></td></tr></table></figure>
<h3 id="操作样式"><a href="#操作样式" class="headerlink" title="操作样式"></a>操作样式</h3><ul>
<li>document.styleSheets 获取所有style样式</li>
<li>sheet.deleteRule(索引)</li>
<li>sheet.insertRule(规则文本, 插入规则的索引) 向现有样式表插入新规则</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var sheet = document.styleSheets[0];</span><br><span class="line">sheet.insertRule(&quot;body &#123;max-width: 1000px;&#125;&quot;, 0);</span><br></pre></td></tr></table></figure>
<h2 id="元素大小"><a href="#元素大小" class="headerlink" title="元素大小"></a>元素大小</h2><h3 id="偏移量"><a href="#偏移量" class="headerlink" title="偏移量"></a>偏移量</h3><ul>
<li>offsetHeight 垂直空间上的占用像素, 包括元素的高度, (可见的)水平滚动条高度, 上边框高度和下边框高度</li>
<li>offsetWidth 水平方向上的占用像素, 包括元素的宽度, (可见的)垂直滚动条宽度, 左边框和右边框的宽度</li>
<li>offsetLeft 元素左外边框至包含元素的左内边框之间的像素距离</li>
<li>offsetTop 元素上外边框至包含元素的上内边框之间的像素距离<br><img src="https://img.alicdn.com/tfs/TB1DpvFSFXXXXcqXXXXXXXXXXXX-1294-770.png" alt="偏移量"></li>
</ul>
<blockquote>
<p>元素的offsetParent和parentNode不一定相等</p>
<p>计算一个元素在页面上的偏移量</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">function getElementLeft(element) &#123;</span><br><span class="line">	var actualLeft = element.offsetLeft;</span><br><span class="line">	var currParent = element.offsetParent;</span><br><span class="line"></span><br><span class="line">	while (currParent != null) &#123;</span><br><span class="line">		actualLeft += currParent.offsetLeft;</span><br><span class="line">		currParent = currParent.offsetParent;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function getElementTop(element) &#123;</span><br><span class="line">	var actualTop = element.offsetTop;</span><br><span class="line">	var currParent = element.offsetParent;</span><br><span class="line"></span><br><span class="line">	while (currParent != null) &#123;</span><br><span class="line">		actualTop += currParent.offsetTop;</span><br><span class="line">		currParent = currParent.offsetParent;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="客户区大小"><a href="#客户区大小" class="headerlink" title="客户区大小"></a>客户区大小</h3><ul>
<li>clientWidth 内容区宽度+左右内边距的宽度</li>
<li>clientHeight 内容区高度+上下内边距的高度</li>
</ul>
<p><img src="https://img.alicdn.com/tfs/TB1L8O2SFXXXXbQaXXXXXXXXXXX-1190-762.png" alt="客户区大小"></p>
<blockquote>
<p>浏览器视口大小</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">function getViewport() &#123;</span><br><span class="line">	//兼容IE7以前</span><br><span class="line">	if (document.compatMode == &quot;BackCompat&quot;) &#123;</span><br><span class="line">		return &#123;</span><br><span class="line">			width: document.body.clientWidth,</span><br><span class="line">			height: document.body.clientHeight</span><br><span class="line">		&#125;</span><br><span class="line">	&#125; else &#123;</span><br><span class="line">		return &#123;</span><br><span class="line">			width: document.documentElement.clientWidth,</span><br><span class="line">			height: document.documentElement.clientHeight</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="滚动大小"><a href="#滚动大小" class="headerlink" title="滚动大小"></a>滚动大小</h3><ul>
<li>scrollHeight 没有滚动条的情况下, 元素内容的总高度</li>
<li>scrollWidth 没有滚动条的情况下, 元素内容的总宽度</li>
<li>scrollLeft 被隐藏在内容左侧的像素数, 可以通过改变此值来改变元素的滚动位置</li>
<li>scrollTop 被隐藏的内容区域上方的像素数, 可以通过改变此值改变元素的滚动位置</li>
</ul>
<blockquote>
<p>当页面大小没有超过视口大小时, <code>scrollHeight</code>与<code>clientHeight</code>, <code>scrollWidth</code>与<code>clientWidth</code>值相等;</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">//chrome 下测试结果  各浏览器结果不一致, 为了兼容性 如果想获取文档高度, 应该取两值的最大值</span><br><span class="line">document.documentElement.scrollHeight;// 2874 最个文档高度</span><br><span class="line">document.documentElement.clientHeight;// 911 视口高度</span><br><span class="line"></span><br><span class="line">document.body.scrollHeight;// 2874 最个文档高度</span><br><span class="line">document.body.clientHeight;// 2874 最个文档高度</span><br></pre></td></tr></table></figure>
<h3 id="确定元素大小"><a href="#确定元素大小" class="headerlink" title="确定元素大小"></a>确定元素大小</h3><ul>
<li>getBoundingClientRect() 获取元素left, right, top, bottom</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">document.documentElement.getBoundingClientRect()</span><br></pre></td></tr></table></figure>
<h2 id="遍历"><a href="#遍历" class="headerlink" title="遍历"></a>遍历</h2><h3 id="NodeIterator"><a href="#NodeIterator" class="headerlink" title="NodeIterator"></a>NodeIterator</h3><ul>
<li>document.createNodeIterator(起始节点, 要访问哪些节点的代码, nodeFilter对象, 是否要扩展实体引用)</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">var div = document.getElementById(&quot;div1&quot;);</span><br><span class="line">var iterator = document.createNodeIterator(div, NodeFilter.SHOW_ELEMENT, null, false);</span><br><span class="line">var node = iterator.nextNode();</span><br><span class="line">while (node !== null) &#123;</span><br><span class="line">	console.log(node.tagName);</span><br><span class="line">	node = iterator.nextNode();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="TreeWalker"><a href="#TreeWalker" class="headerlink" title="TreeWalker"></a>TreeWalker</h3><ul>
<li>document.createTreeWalk(起始节点, 要访问哪些节点的代码, nodeFilter对象, 是否要扩展实体引用)</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">var div = document.getElementById(&quot;div1&quot;);</span><br><span class="line">var filter = function(node) &#123;</span><br><span class="line">	return node.tagName.toLowerCase() == &apos;li&apos; ? NodeFilter.FILTER_ACCEPT : NodeFilter.FILTER_SKIP;</span><br><span class="line">&#125;</span><br><span class="line">var iterator = document.createTreeWalk(div, NodeFilter.SHOW_ELEMENT, filter, false);</span><br><span class="line">var node = iterator.nextNode();</span><br><span class="line">while (node !== null) &#123;</span><br><span class="line">	console.log(node.tagName);</span><br><span class="line">	node = iterator.nextNode();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://blog.hellolc.com/2017/08/05/dom23/" data-id="cl7e5jfgl0028do5wmjkewst4" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javaScript高级程序设计笔记/">javaScript高级程序设计笔记</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-DOM扩展" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/08/02/DOM扩展/" class="article-date">
  <time datetime="2017-08-02T01:53:53.000Z" itemprop="datePublished">2017-08-02</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/08/02/DOM扩展/">DOM扩展</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="选择符API"><a href="#选择符API" class="headerlink" title="选择符API"></a>选择符API</h2><h3 id="querySelector-方法"><a href="#querySelector-方法" class="headerlink" title="querySelector()方法"></a>querySelector()方法</h3><blockquote>
<p>可以接受一个css选择符, 返回匹配的第一个元素, 如果没有找到匹配的元素, 返回null</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">//获取body</span><br><span class="line">document.querySelector(&quot;body&quot;);</span><br><span class="line"></span><br><span class="line">//获取id为div的元素</span><br><span class="line">document.querySelector(&quot;#div&quot;);</span><br></pre></td></tr></table></figure>
<h3 id="querySelectorAll-方法"><a href="#querySelectorAll-方法" class="headerlink" title="querySelectorAll()方法"></a>querySelectorAll()方法</h3><blockquote>
<p>可以接受一个css选择符, 返回所有匹配的第一个元素, 如果没有找到匹配的元素, 返回null</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">//获取所有类为myClass的元素</span><br><span class="line">document.querySelectorAll(&quot;.myClass&quot;);</span><br><span class="line"></span><br><span class="line">//获取所有div下的所有p元素</span><br><span class="line">document.querySelectorAll(&quot;div p&quot;);</span><br></pre></td></tr></table></figure>
<h3 id="matchesSelector-方法"><a href="#matchesSelector-方法" class="headerlink" title="matchesSelector()方法"></a>matchesSelector()方法</h3><blockquote>
<p>选择的元素是否与之匹配, 匹配返回true, 否则返回false; 目前不是所有浏览器支持, 需要添加浏览器标识</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">if (document.body.matchesSelector &amp;&amp; document.body.matchesSelector(&quot;body&quot;)) &#123;</span><br><span class="line">	//do someting</span><br><span class="line">&#125; else if (document.body.webkitMatchesSelector &amp;&amp; document.body.webkitMatchesSelector(&quot;body&quot;)) &#123;</span><br><span class="line">	//do someting</span><br><span class="line">&#125; else if (document.body.msMatchesSelector &amp;&amp; document.body.msMatchesSelector(&quot;body&quot;)) &#123;</span><br><span class="line">	//do someting</span><br><span class="line">&#125; else if (document.body.mozMatchesSelector &amp;&amp; document.body.mozMatchesSelector(&quot;body&quot;)) &#123;</span><br><span class="line">	//do someting</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="元素遍历"><a href="#元素遍历" class="headerlink" title="元素遍历"></a>元素遍历</h2><blockquote>
<p>因为ie9以前是版本, 对于元素间的空格, 不会作为节点返回, 因此childNodes和firstChild等元素在不同浏览器下结果不一样, 所以w3c又引入了新的属性来获取元素</p>
</blockquote>
<ul>
<li>childElementCount 返回子元素个数(不包含空格和注释)</li>
<li>firstElementChild 返回第一个子元素</li>
<li>lastElementChild 返回最后一个子元素</li>
<li>previousElementSibling 返回前一个同辈元素</li>
<li>nextElementSibling 返回后一个同辈元素</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">//之前的做法</span><br><span class="line">var child = element.firstChild;</span><br><span class="line">while (child != element.lastChild) &#123;</span><br><span class="line">	if (child.nodeType == 1) &#123;</span><br><span class="line">		processChild(child)</span><br><span class="line">	&#125;</span><br><span class="line">	child = child.nextSibling;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//现在用新的属性, 可简化如下</span><br><span class="line">var child = element.firstElementChild;</span><br><span class="line">while (child != element.lastElementChild) &#123;</span><br><span class="line">	processChild(child)</span><br><span class="line">	child = child.nextElementSibling;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="HTML5"><a href="#HTML5" class="headerlink" title="HTML5"></a>HTML5</h2><h3 id="与类相关的扩充"><a href="#与类相关的扩充" class="headerlink" title="与类相关的扩充"></a>与类相关的扩充</h3><ul>
<li>getElementsByClass()方法<ul>
<li>类名选择器</li>
<li>返回nodeList, 所以和其他返回nodeList的选择器一样有性能问题</li>
<li>IE9+支持</li>
</ul>
</li>
<li>classList属性<ul>
<li>add(类名) 添加类名</li>
<li>remove(类名) 删除类名</li>
<li>contains(类名) 判断是否包含类名</li>
<li>toggle(类名) 有对应类名就删除, 没有就添加</li>
<li>Firefox3.6+和chrome</li>
</ul>
</li>
</ul>
<h3 id="焦点管理"><a href="#焦点管理" class="headerlink" title="焦点管理"></a>焦点管理</h3><ul>
<li>document.activeElement 获取文档焦点对象</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">var btn = document.getElementById(&quot;btn&quot;);</span><br><span class="line">btn.focus();</span><br><span class="line">btn === document.activeElement; //true</span><br></pre></td></tr></table></figure>
<ul>
<li>document.hasFocus() 判断文档是否获取焦点对象</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">var btn = document.getElementById(&quot;btn&quot;);</span><br><span class="line">btn.focus();</span><br><span class="line">document.hasFocus(); //true</span><br></pre></td></tr></table></figure>
<h3 id="HTMLDocument的扩展"><a href="#HTMLDocument的扩展" class="headerlink" title="HTMLDocument的扩展"></a>HTMLDocument的扩展</h3><ul>
<li>readyState 属性 判断文档是否加载完毕<ul>
<li>其值为loading, 正在加载文档</li>
<li>其值为complete, 已经加载完文档</li>
</ul>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">if (document.readyState == &apos;complete&apos;) &#123;</span><br><span class="line">	//do something</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><p>compatMode 渲染模式</p>
<ul>
<li>CSS1Compat 标准模式</li>
<li>BackCompat 兼容模式</li>
</ul>
</li>
<li><p>head 属性 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var head  = document.head || document.getElementsByTagName(&quot;head&quot;)[0]</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="字符集属性"><a href="#字符集属性" class="headerlink" title="字符集属性"></a>字符集属性</h3><ul>
<li>document.charset 当前浏览器字符集</li>
<li>document.defaultCharset 浏览器或系统默认字符</li>
</ul>
<h3 id="自定义数据属性"><a href="#自定义数据属性" class="headerlink" title="自定义数据属性"></a>自定义数据属性</h3><ul>
<li>dataset</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;div data-id=&quot;123&quot; data-name=&quot;hello&quot;&gt;&lt;/div&gt;</span><br><span class="line">var div = document.getElementsByTagName(&quot;div&quot;)[0];</span><br><span class="line">div.dataset.id = &quot;321&quot;;</span><br><span class="line">div.dataset.name; //&quot;hello&quot;</span><br></pre></td></tr></table></figure>
<h3 id="插入标记"><a href="#插入标记" class="headerlink" title="插入标记"></a>插入标记</h3><ul>
<li>innerHTML 属性</li>
<li>outerHTML 属性</li>
<li>insertAdjacentHTML() 方法, 接受2个参数, 第一个参数要插入的位置, 第二个参数要插入的html文本<br>第一个参数为下:<ul>
<li>“beforebegin” 在当前元素之前插入一个紧邻的同辈元素</li>
<li>“afterbegin” 在当前元素之后插入一个新的子元素或在第一个子元素之前再插入新的子元素</li>
<li>“beforeend” 在当前元素之后插入一个新的子元素或在最后一个子元素之后再插入新的子元素</li>
<li>“afterend” 在当前元素之后插入一个紧邻的同辈元素</li>
</ul>
</li>
<li>内存与性能问题</li>
</ul>
<blockquote>
<p>以上方法有可能导致内存泄露, 因为替换了dom节点后, 之前的dom节点还会在内存中, 因此如果多次替换节点时, 应该先删除要被替换的节点;<br>当插入大量html标签时, 建议先拼接好html, 再进行innerHTML或者outerHTML属性, 不要频繁使用, 效率较低</p>
</blockquote>
<h3 id="scrollIntoView-方法"><a href="#scrollIntoView-方法" class="headerlink" title="scrollIntoView() 方法"></a>scrollIntoView() 方法</h3><blockquote>
<p>可以让元素的位置与视口对其, 如果传入true或者不传, 则让元素的顶部与视口对其, 如果传入false, 则尽可能让元素全部出现在视口中</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">document.getElementsByClassName(&quot;cr-content &quot;)[2].scrollIntoView()</span><br><span class="line">document.getElementsByClassName(&quot;cr-content &quot;)[2].scrollIntoView(true);</span><br><span class="line"></span><br><span class="line">document.getElementsByClassName(&quot;cr-content &quot;)[2].scrollIntoView(false)</span><br></pre></td></tr></table></figure>
<h2 id="专有扩展"><a href="#专有扩展" class="headerlink" title="专有扩展"></a>专有扩展</h2><h3 id="文档模式"><a href="#文档模式" class="headerlink" title="文档模式"></a>文档模式</h3><blockquote>
<p>浏览器有很多种渲染模式, 为了强制浏览器以某种模式渲染页面, 可以通过一下方式设置</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=IEVersion&quot;&gt;</span><br></pre></td></tr></table></figure>
<h3 id="contains"><a href="#contains" class="headerlink" title="contains"></a>contains</h3><blockquote>
<p>判断是否包含子节点元素</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">document.documentElement.contains(document.head)//true</span><br></pre></td></tr></table></figure>
<h3 id="compareDocumentPosition"><a href="#compareDocumentPosition" class="headerlink" title="compareDocumentPosition"></a>compareDocumentPosition</h3><blockquote>
<p>是一个DOM3级的方法, 来判断节点元素与当前元素的相对位置, 功能和contains类似;<br>其返回值为数字, 1 表示无关, 2表示居前, 4表示居后, 8表示包含, 16表示被包含</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 如下返回20, 是因为document.head被包含, 并且居后, 所以加上4, 就是20</span><br><span class="line">document.documentElement.compareDocumentPosition(document.head);//20</span><br></pre></td></tr></table></figure>
<h3 id="插入文本"><a href="#插入文本" class="headerlink" title="插入文本"></a>插入文本</h3><ul>
<li>innerText 删除元素节点, 返回文档节点, 或是对文本节点的替换; 如果有元素节点进行替换, 都会被转译掉, 所以为了安全, 在添加文本节点时, 应该使用innerText, 而不是innerHTML</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">function getInnerText(element) &#123;</span><br><span class="line">	return (typeof element.textContent == &apos;string&apos;) ? element.textContent : element.innerText;</span><br><span class="line">&#125;</span><br><span class="line">function setInnerText(element, text) &#123;</span><br><span class="line">	if (typeof element.textContent == &apos;string&apos;) &#123;</span><br><span class="line">		element.textContent = text;</span><br><span class="line">	&#125; else &#123;</span><br><span class="line">		element.innerText = text;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>outerText<blockquote>
<p>读取功能和<code>innerText</code>类似, 但是写的时候, 会替换掉原来的整个元素(包括子节点), 因此不建议使用</p>
</blockquote>
</li>
</ul>
<h3 id="滚动"><a href="#滚动" class="headerlink" title="滚动"></a>滚动</h3><ul>
<li>scrollIntoView() 这个前面说过</li>
<li>scrollIntoViewIfNeeded() 功能和scrollIntoView类似, 但只在指定的元素不在可视区时才生效</li>
<li>scrollByLines(lineCount) 将元素内容滚动指定的行高, lineCount可正可负</li>
<li>scrollByPages(pageCount) 将元素内容滚到到指定的页面高度</li>
</ul>
<blockquote>
<p>以上就scrollIntoView所有浏览器都已支持, 其他都只有部分浏览器支持</p>
</blockquote>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://blog.hellolc.com/2017/08/02/DOM扩展/" data-id="cl7e5jffa0006do5wjmqnv6kd" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javaScript高级程序设计笔记/">javaScript高级程序设计笔记</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-DOM" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/07/14/DOM/" class="article-date">
  <time datetime="2017-07-14T01:43:27.000Z" itemprop="datePublished">2017-07-14</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/07/14/DOM/">DOM</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="节点层次"><a href="#节点层次" class="headerlink" title="节点层次"></a>节点层次</h2><blockquote>
<p>如下, 最外层的节点<html>, 称为文档元素, 每个文档只能有一个文档元素;<br>在html页面中, 文档元素始终都是<html>元素;</html></html></p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">  &lt;head&gt;</span><br><span class="line">    &lt;title&gt;Home&lt;/title&gt;</span><br><span class="line">  &lt;/head&gt;</span><br><span class="line">  &lt;body&gt;</span><br><span class="line">    &lt;p&gt;hello wolrd!&lt;/p&gt;</span><br><span class="line">  &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<h3 id="Node类型"><a href="#Node类型" class="headerlink" title="Node类型"></a>Node类型</h3><blockquote>
<p>节点类型如下:</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">Node.ELEMENT_NODE(1);</span><br><span class="line">Node.ATTRIBUTE_NODE(2);</span><br><span class="line">Node.TEXT_NODE(3);</span><br><span class="line">Node.CDATA_SECTION_NODE(4);</span><br><span class="line">Node.ENTITY_REFERENCE_NODE(5);</span><br><span class="line">Node.ENTITY_NODE(6);</span><br><span class="line">Node.PROCESSING_INSTRUCTION_NODE(7);</span><br><span class="line">Node.COMMENT_NODE(8);</span><br><span class="line">Node.DOCUMENT_NODE(9);</span><br><span class="line">Node.DOCUMENT_TYPE_NODE(10);</span><br><span class="line">Node.DOCUMENT_FRAGMENT_NODE(11);</span><br><span class="line">Node.NOTATION_NODE(12);</span><br><span class="line"></span><br><span class="line">//可以通过如下方式判断</span><br><span class="line">if (someNode.nodeType == 1) &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="nodeName和nodeValue属性"><a href="#nodeName和nodeValue属性" class="headerlink" title="nodeName和nodeValue属性"></a>nodeName和nodeValue属性</h3><blockquote>
<p><code>nodeName</code>元素的标签名, <code>nodeValue</code>节点值</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">var someNode = document.getElementById(&apos;html&apos;);</span><br><span class="line">someNode.nodeName;//&quot;html&quot;</span><br><span class="line">someNode.nodeValue;//null</span><br></pre></td></tr></table></figure>
<h3 id="节点关系"><a href="#节点关系" class="headerlink" title="节点关系"></a>节点关系</h3><blockquote>
<p>每个节点都有一个childNodes属性, 保存着一个NodeList对象, NodeList是一种类数组对象(有length属性, 但不是数组);<br>可以通过previousSibling和nextSibling属性, 可以访问同一列表中的相邻其他节点.<br>firstChild获取第一个节点, lastChild获取最后一个节点;<br>parentNode可以获取父节点;<br>hasChildNodes()可以判断是否有子节点;<br>所有节点都有一个属性是ownerDocument, 该属性指向整个文档的文档节点, 即: document;<br>以下为获取NoeList中的节点方法</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">var firstChild = someNode.childNodes[0];</span><br><span class="line">var secondChild = someNode.childNodes.item(1);</span><br><span class="line"></span><br><span class="line">firstChild.nextSibling == secondChild;//true</span><br><span class="line">secondChild.previousSibling == firstChild;//true</span><br><span class="line">someNode.firstChild == firstChild//true</span><br><span class="line">someNode.lastChild == someNode.childNodes[someNode.childNodes.length - 1]; //true</span><br><span class="line">someNode.firstChild.parentNode == someNode;//true</span><br></pre></td></tr></table></figure>
<blockquote>
<p>由于NodeList是类数组, 可以通过Array.prototype.slice.call(NodeList, 0)方式转换为数组, 但是需要IE8以上, 因为IE8及一下是DOM是用COM对象实现的, 不是JScript;</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">function convertToArray(nodes) &#123;</span><br><span class="line">  var array = [];</span><br><span class="line">  try &#123;</span><br><span class="line">    array = Array.prototype.slice.call(nodes, 0);//针对非IE浏览器</span><br><span class="line">  &#125; catch (ex) &#123;</span><br><span class="line">    for (var i=0, len=nodes.length; i &lt; len; i++) &#123;</span><br><span class="line">      array.push(nodes[i]);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  return array;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="操作节点"><a href="#操作节点" class="headerlink" title="操作节点"></a>操作节点</h3><blockquote>
<p>appendChild()想childNodes列表的末尾添加一个节点;<br>insertBefore(要插入的节点, 参照的节点); 可以把节点放在childNodes列表中某个特定的位置上, 如果参照节点为null, 则insertBefore与appendChild执行相同的操作;<br>replaceChild(要插入的节点, 替换节点);<br>removeChild(要移除的节点);</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">var returnedNode = someNodes.appendChild(newNode);</span><br><span class="line">returnedNode == newNode; //true</span><br><span class="line">someNodes.lastChild == newNode; //true</span><br><span class="line"></span><br><span class="line">//在末尾插入</span><br><span class="line">someNodes.insertBefore(newNode, null);</span><br><span class="line">someNodes.lastChild == newNode; //true</span><br><span class="line"></span><br><span class="line">//插入到第一个</span><br><span class="line">someNodes.insertBefore(newNode, newNode.firstChild);</span><br><span class="line">someNodes.firstChild == newNode; //true</span><br><span class="line"></span><br><span class="line">//替换第一个节点</span><br><span class="line">someNodes.replaceChild(newNode, someNodes.firstChild);</span><br><span class="line"></span><br><span class="line">//移除第一个节点</span><br><span class="line">someNodes.removeChild(someNodes.firstChild);</span><br></pre></td></tr></table></figure>
<h3 id="其他方法"><a href="#其他方法" class="headerlink" title="其他方法"></a>其他方法</h3><blockquote>
<p>cloneNode(是否深复制子节点)克隆节点; 当传递为true时, 会复制节点自身和它的子节点, 否则只复制自身, 复制后返回的节点副本属于文档所有, 但并没有为它指定父节点. 需要通过appendChild(), insertBefore()或replaceChild()将它添加到文档中. cloneNode()不会复制DOM节点中的JavaScript属性, 例如事件处理程序等.IE在此存在一个bug, 即它会复制事件处理程序, 所以我们建议在复制之前最好先移除事件处理程序;<br>normalize()处理文档树中的文本节点, 删除节点的后代节点中的空文本节点, 或是将相邻的文本节点, 合并为一个文本节点.</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;ul&gt;</span><br><span class="line">  &lt;li&gt;item 1&lt;/item&gt;</span><br><span class="line">  &lt;li&gt;item 2&lt;/item&gt;</span><br><span class="line">  &lt;li&gt;item 3&lt;/item&gt;</span><br><span class="line">&lt;/ul&gt;</span><br><span class="line">var deepList = myList.cloneNode(true);</span><br><span class="line">console.log(deepList.childNodes.length);//3(IE&lt;9)或7(其他浏览器)</span><br><span class="line"></span><br><span class="line">var shallowList = myList.cloneNode(false);</span><br><span class="line">console.log(shallowList.childNodes.length);//0</span><br></pre></td></tr></table></figure>
<h2 id="document类型"><a href="#document类型" class="headerlink" title="document类型"></a>document类型</h2><blockquote>
<p>document是HTMLDocument的一个实例</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">document.nodeType//9</span><br><span class="line">document.nodeName //#document</span><br><span class="line">document.nodeValue//null</span><br><span class="line">document.parentNode//null</span><br><span class="line">document.ownerDocument//null</span><br></pre></td></tr></table></figure>
<h3 id="文档的子节点"><a href="#文档的子节点" class="headerlink" title="文档的子节点"></a>文档的子节点</h3><ul>
<li>document.documentElement</li>
<li>document.body</li>
<li>document.doctype(只读), 各浏览器对其是否解析为document的子节点各不相同</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">  &lt;head&gt;&lt;/head&gt;</span><br><span class="line">  &lt;body&gt;&lt;/body&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line"></span><br><span class="line">document.childNodes[0] === document.documentElement //true</span><br></pre></td></tr></table></figure>
<h3 id="文档信息"><a href="#文档信息" class="headerlink" title="文档信息"></a>文档信息</h3><ul>
<li>document.title 获取标题信息, 修改标题</li>
<li>document.URL(只读) 当前地址</li>
<li>document.referrer(只读) 来源网站的URL</li>
<li>document.domain</li>
</ul>
<blockquote>
<p>由于安全方面的限制, 这个值只能设置为URL中的子域名, 比如<code>www.test.com</code>只能设置为<code>test.com</code>;<br>这个值的用处是, 当一个页面嵌套一个同域子页面时, 如果要想通过JavaScript进行通信, 则必须将两个页面的document.domain设置为同一个域, 才可以进行通信;</p>
</blockquote>
<ul>
<li>namedItem<blockquote>
<p>对<code>HTMlCollection</code>集合调用数字索引值时, 就会调用<code>item()</code>方法, 如果调用字符串索引值就会调用<code>namedItem()</code>方法</p>
</blockquote>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src=&quot;myimage.gif&quot; name=&quot;myImage&quot;&gt;</span><br><span class="line">// 获取HTMLCollection集合</span><br><span class="line">var images = document.getElementByTagName(&quot;img&quot;)</span><br><span class="line">images.namedItem(&quot;myImage&quot;);</span><br><span class="line">//等价于</span><br><span class="line">images[&quot;myImage&quot;]</span><br></pre></td></tr></table></figure>
<blockquote>
<p><code>document.getElementByTagName(&#39;*&#39;)</code>可以获取所有元素, 但是在ie下注释的元素也会被获取</p>
</blockquote>
<h3 id="特殊集合"><a href="#特殊集合" class="headerlink" title="特殊集合"></a>特殊集合</h3><ul>
<li>document.anchors 所有带<code>name</code>标签的<code>&lt;a&gt;</code>元素</li>
<li>document.applets 所有<code>&lt;applets&gt;</code>元素</li>
<li>document.forms 所有<code>&lt;form&gt;</code>元素</li>
<li>document.images 所有<code>&lt;img&gt;</code> 元素</li>
<li>document.links 所有带<code>href</code>特性的<code>&lt;a&gt;</code>元素</li>
<li>document.write() 将输出流写入网页</li>
<li>document.writeln() 将输出流写入网页并换行</li>
</ul>
<blockquote>
<p><code>document.write/writeln</code> 这2个方法会重写<code>整个页面</code>, 还有如果输出<code>&lt;/script&gt;</code>一定要转译成<code>&lt;\/script&gt;</code>, 否则会报错</p>
</blockquote>
<h2 id="Element类型"><a href="#Element类型" class="headerlink" title="Element类型"></a>Element类型</h2><ul>
<li>nodeType值为1</li>
<li>nodeName/tagName值为元素的标签名</li>
<li>nodeValue值为null</li>
<li>parentNode值为Document或Element</li>
</ul>
<blockquote>
<p>nodeName一般为大写, 所以先进行转大小写, 再进行比较</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;a&gt;我是a标签&lt;/a&gt;</span><br><span class="line">var a = document.getElementsByTagName(&quot;a&quot;)[0]</span><br><span class="line">a.nodeName //A</span><br><span class="line">a.nodeName === a.tagName//true</span><br><span class="line">if (a.nodeName.toLowerCase == &apos;a&apos;) &#123;</span><br><span class="line">  //do something</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="html元素"><a href="#html元素" class="headerlink" title="html元素"></a>html元素</h3><blockquote>
<p>每个html元素都有如下属性</p>
</blockquote>
<ul>
<li>id</li>
<li>title</li>
<li>className</li>
<li>lang 元素内容的语言代码, 很少使用</li>
<li>dir 语言的方法, 值为 “ltr” 或 “rtl”</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;div id=&quot;div1&quot; class=&quot;myClass&quot; title=&quot;myTitle&quot; lang=&quot;en&quot; dir=&quot;ltr&quot;&gt;&lt;/div&gt;</span><br><span class="line">var div = document.getElementById(&quot;div1&quot;);</span><br><span class="line">div.id;//div1</span><br><span class="line">div.className;//myClass</span><br><span class="line">div.title;//myTitle</span><br><span class="line">div.lang;//en</span><br><span class="line">div.dir;//ltr</span><br></pre></td></tr></table></figure>
<h3 id="取得特性"><a href="#取得特性" class="headerlink" title="取得特性"></a>取得特性</h3><ul>
<li>getAttribute() 获取属性, 获取的属性名与实际相同, 所以获取class时, 使用getAttribute(‘class’)就可以而不是className</li>
</ul>
<blockquote>
<p>只有公认的属性会添加到DOM对象上(ie除外), 其他的自定义属性需要使用<code>getAttribute()</code>获取;<br>获取<code>style</code>属性时会返回一个对象或是<code>null</code>, 获取事件属性时会返回函数或者<code>null</code></p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;div id=&quot;div1&quot; class=&quot;myClass&quot; my_attr=&quot;myAttr&quot;&gt;&lt;/div&gt;</span><br><span class="line">var div = document.getElementById(&quot;div1&quot;);</span><br><span class="line">div.my_attr;//undefined(ie除外)</span><br><span class="line">div.getAttribute(&quot;my_attr&quot;);//myAttr</span><br><span class="line">div.getAttribute(&quot;class&quot;);//myClass</span><br></pre></td></tr></table></figure>
<h3 id="设置特性"><a href="#设置特性" class="headerlink" title="设置特性"></a>设置特性</h3><ul>
<li>setAttribute() 设置属性</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;div id=&quot;div1&quot; class=&quot;myClass&quot; my_attr=&quot;myAttr&quot;&gt;&lt;/div&gt;</span><br><span class="line">var div = document.getElementById(&quot;div1&quot;);</span><br><span class="line">div.setAttribute(&quot;title&quot;, &quot;myTitle&quot;);</span><br><span class="line">div.className = &quot;newClass&quot;;</span><br><span class="line">//如果这样直接设置属性, 在大多数浏览器下, 这个属性不会自动变成元素的特性, 因此用getAttribute(&quot;myColor&quot;)结果为null</span><br><span class="line">div.myColor = &quot;red&quot;;</span><br></pre></td></tr></table></figure>
<h3 id="删除属性"><a href="#删除属性" class="headerlink" title="删除属性"></a>删除属性</h3><ul>
<li>removeAttribute() 删除属性</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;div id=&quot;div1&quot; class=&quot;myClass&quot; my_attr=&quot;myAttr&quot;&gt;&lt;/div&gt;</span><br><span class="line">var div = document.getElementById(&quot;div1&quot;);</span><br><span class="line">div.removeAttribute(&quot;class&quot;);</span><br></pre></td></tr></table></figure>
<h3 id="attributes属性"><a href="#attributes属性" class="headerlink" title="attributes属性"></a>attributes属性</h3><ul>
<li>getNamedItem(name) 获取名为name的属性</li>
<li>removeNamedItem(name) 删除名为name的属性</li>
<li>setNamedItem(node) 向列表中添加节点, 以节点的nodeName为索引</li>
<li>item(pos) 返回位于数字pos位置的节点</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">var id = element.attributes.getNamedItem(&quot;id&quot;).nodeValue;</span><br><span class="line">//等价于如下</span><br><span class="line">var id = element.attributes[&quot;id&quot;].nodeValue;</span><br></pre></td></tr></table></figure>
<h3 id="创建元素"><a href="#创建元素" class="headerlink" title="创建元素"></a>创建元素</h3><ul>
<li>document.createElement()</li>
</ul>
<blockquote>
<p>由于在ie7以下, 某些动态创建的元素会有问题, 建议使用完整的html创建, 其他浏览器就使用标签创建</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">if (client.browser.ie &amp;&amp; client.browser.ie &lt;= 7) &#123;</span><br><span class="line">  var iframe = document.createElement(&quot;&lt;iframe name=\&quot;myName\&quot;&gt;&lt;/iframe&gt;&quot;);</span><br><span class="line">&#125; else &#123;</span><br><span class="line">  var iframe = document.createElement(&quot;iframe&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="元素子节点"><a href="#元素子节点" class="headerlink" title="元素子节点"></a>元素子节点</h3><blockquote>
<p>除ie浏览器外, 都会计算子节点下的空白节点, 因此判断子节点时候, 对nodeType进行判断是否为1</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;ul&gt;</span><br><span class="line">  &lt;li&gt;&lt;/li&gt;</span><br><span class="line">  &lt;li&gt;&lt;/li&gt;</span><br><span class="line">  &lt;li&gt;&lt;/li&gt;</span><br><span class="line">&lt;/ul&gt;</span><br><span class="line"></span><br><span class="line">var element = document.getElementsByTagName(&apos;ul&apos;)[0];</span><br><span class="line">element.childNodes.length; //非ie为3, 其他浏览器为7</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//-----------------</span><br><span class="line">&lt;ul&gt;&lt;li&gt;&lt;/li&gt;&lt;li&gt;&lt;/li&gt;&lt;li&gt;&lt;/li&gt;&lt;/ul&gt;</span><br><span class="line"></span><br><span class="line">var element = document.getElementsByTagName(&apos;ul&apos;)[0];</span><br><span class="line">element.childNodes.length; //所有浏览器都为3</span><br><span class="line"></span><br><span class="line">for (var i = 0; i &lt; element.childNodes.length; i++) &#123;</span><br><span class="line"></span><br><span class="line">  if (element.childNodes[i].nodeType == 1) &#123;</span><br><span class="line">    //do something</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="文本节点"><a href="#文本节点" class="headerlink" title="文本节点"></a>文本节点</h2><ul>
<li>nodeType值为3</li>
<li>nodeName值为”#text”</li>
<li>nodeValue值为节点所包含的内容</li>
<li>parentNode是一个元素节点</li>
<li>不支持子节点</li>
<li>appendData(text) 将text添加到节点末尾</li>
<li>deleteData(offset, count) 从offset开始删除count个字符</li>
<li>insertData(offset, text) 从offset开始插入text</li>
<li>replaceData(offset, count, text) 从offset开始, 替换count个字符为text</li>
<li>splitText(offset) 从offset位置开始讲文本分成两个文本节点</li>
<li>substringData(offset, count) 获取从offset到offset+count为止的字符串</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;span&gt;hello&lt;/span&gt;</span><br><span class="line"></span><br><span class="line">var spanText = document.getElementsByTagName(&quot;span&quot;)[0].childNodes[0];</span><br><span class="line">spanText.appendData(&quot; world&quot;);// hello world</span><br><span class="line">spanText.deleteData(5, 6);// hello</span><br><span class="line"></span><br><span class="line">//默认情况下, 至多有一个文本节点</span><br><span class="line">&lt;span&gt;&lt;/span&gt; //没有文本节点</span><br><span class="line">&lt;span&gt; &lt;/span&gt; //有空格 所以有文本节点</span><br></pre></td></tr></table></figure>
<h3 id="创建文本节点"><a href="#创建文本节点" class="headerlink" title="创建文本节点"></a>创建文本节点</h3><ul>
<li>document.createTextNode</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;span&gt;hello&lt;/span&gt;</span><br><span class="line"></span><br><span class="line">var ele = document.getElementsByTagName(&quot;span&quot;)[0];</span><br><span class="line">var textNode = document.createTextNode(&quot; world&quot;)</span><br><span class="line">ele.appendChild(textNode);</span><br></pre></td></tr></table></figure>
<h3 id="规范化文本节点"><a href="#规范化文本节点" class="headerlink" title="规范化文本节点"></a>规范化文本节点</h3><ul>
<li>normalize() 可以将多个子文本节点变成一个</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;span&gt;hello&lt;/span&gt;</span><br><span class="line"></span><br><span class="line">var ele = document.getElementsByTagName(&quot;span&quot;)[0];</span><br><span class="line">var textNode = document.createTextNode(&quot; world&quot;)</span><br><span class="line">ele.appendChild(textNode);</span><br><span class="line">ele.childNodes.length;//2</span><br><span class="line">ele.normalize();</span><br><span class="line">ele.childNodes.length;//1</span><br></pre></td></tr></table></figure>
<h3 id="分割文本节点"><a href="#分割文本节点" class="headerlink" title="分割文本节点"></a>分割文本节点</h3><ul>
<li>splitText(offset) 指定位置分割文本节点, 功能和normalize()相反</li>
</ul>
<h2 id="comment类型"><a href="#comment类型" class="headerlink" title="comment类型"></a>comment类型</h2><blockquote>
<p>注释节点 功能与text节点相似, 就少一个splitText方法</p>
</blockquote>
<ul>
<li>nodeType值为8</li>
<li>nodeName值为”#comment</li>
<li>nodeValue值为注释内容</li>
<li>parentNode值为Document或Element</li>
<li>没有子节点</li>
<li>document.createComment() 创建注释</li>
</ul>
<h3 id="DocumentFragment类型"><a href="#DocumentFragment类型" class="headerlink" title="DocumentFragment类型"></a>DocumentFragment类型</h3><blockquote>
<p>DocumentFragment类型节点类似一个节点仓库, 如果直接在节点树里添加新节点, 会导致页面重绘, 所以我们可以将多次添加的节点,<br>先放到DocumentFragment节点里先, 再添加到dom树中, 这样只需重绘一次就够了.</p>
</blockquote>
<ul>
<li>nodeType值为11</li>
<li>nodeName值为”#document-fragment</li>
<li>nodeValue值为null</li>
<li>parentNode值为null</li>
<li>document.createDocumentFragment()</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">var fragment = document.createDocumentFragment();</span><br><span class="line">var ul = document.getElementById(&quot;myUl&quot;);</span><br><span class="line"></span><br><span class="line">for (var i=0; i &lt; 3; i++) &#123;</span><br><span class="line">  var li = document.createElement(&apos;li&apos;);</span><br><span class="line">  fragment.appendChild(li);</span><br><span class="line">&#125;</span><br><span class="line">ul.appendChild(fragment);</span><br></pre></td></tr></table></figure>
<h2 id="DOM操作技术"><a href="#DOM操作技术" class="headerlink" title="DOM操作技术"></a>DOM操作技术</h2><h3 id="动态脚本"><a href="#动态脚本" class="headerlink" title="动态脚本"></a>动态脚本</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">function loadScriptStirng(code) &#123;</span><br><span class="line">  var script = document.createElement(&quot;script&quot;);</span><br><span class="line">  script.type = &quot;text/javascript&quot;;</span><br><span class="line">  try &#123;</span><br><span class="line">    script.appendChild(document.createTextNode(code));</span><br><span class="line">  &#125; catch(e) &#123;</span><br><span class="line">    script.text = code;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  var head = document.getElemntsByTagName(&quot;head&quot;)[0];</span><br><span class="line">  head.appendChild(script);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="动态样式"><a href="#动态样式" class="headerlink" title="动态样式"></a>动态样式</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">function loadStyleString(code) &#123;</span><br><span class="line">  var style = document.createElement(&quot;style&quot;);</span><br><span class="line">  style.type = &quot;text/css&quot;;</span><br><span class="line">  try &#123;</span><br><span class="line">    style.appendChild(document.createTextNode(code))</span><br><span class="line">  &#125; catch(e) &#123;</span><br><span class="line">    style.styleSheet.cssText = code;</span><br><span class="line">  &#125;</span><br><span class="line">  var head = document.getElemntsByTagName(&quot;head&quot;)[0];</span><br><span class="line">  head.appendChild(style);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="操作表单"><a href="#操作表单" class="headerlink" title="操作表单"></a>操作表单</h3><blockquote>
<p>因为表格创建比较繁杂, 所以js封装了一些特殊方法, 简化了创建方式</p>
</blockquote>
<p><img src="https://img.alicdn.com/tfs/TB1vSxxSFXXXXXPXVXXXXXXXXXX-1772-1278.png" alt="表格创建方法"><br><img src="https://img.alicdn.com/tfs/TB1S2w.SpXXXXcYapXXXXXXXXXX-2088-1516.png" alt="表格创建方法2"></p>
<h3 id="使用NodeList"><a href="#使用NodeList" class="headerlink" title="使用NodeList"></a>使用NodeList</h3><blockquote>
<p>NodeList, NamedNodeMap和HTMLCollection, 这3个集合都是动态的; 也就是说, 每次文档结构发生变化时, 它们都会得到更新; 一般来说, 应尽量减少访问NodeList的次数, 因为每次访问NodeList, 都会运行一次基于文档的查询;</p>
<p>如下操作会导致无线循环, 应该避免</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">var divArr = document.getElementByTagName(&quot;div&quot;);</span><br><span class="line"></span><br><span class="line">//divArr.length 每次操作后都会变动</span><br><span class="line">for (var i = 0; i &lt; divArr.length; i++) &#123;</span><br><span class="line">  var div = document.createElement(&quot;div&quot;);</span><br><span class="line">  document.body.appendChild(div);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//应该优化为如下</span><br><span class="line">for (var i = 0, len = divArr.length; i &lt; len; i++) &#123;</span><br><span class="line">  var div = document.createElement(&quot;div&quot;);</span><br><span class="line">  document.body.appendChild(div);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://blog.hellolc.com/2017/07/14/DOM/" data-id="cl7e5jff70004do5wjhiocemi" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javaScript高级程序设计笔记/">javaScript高级程序设计笔记</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-客户端检测" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/07/13/客户端检测/" class="article-date">
  <time datetime="2017-07-13T01:29:54.000Z" itemprop="datePublished">2017-07-13</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/07/13/客户端检测/">客户端检测</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>因为历史的原因, 每个浏览器都会给自己的ua上添加<code>Mozilla</code>的标识, 来伪装成<code>Mozilla</code>浏览器, 能够让服务器响应, 然后再添加上自己浏览器的内核信息以及版本, 所以只能通过这些信息识别, 而且必须按照一定顺序判断, 才能识别真实的浏览器信息; 识别方法如下:</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br></pre></td><td class="code"><pre><span class="line">var client = function() &#123;</span><br><span class="line">  var engine = &#123;</span><br><span class="line">      // 呈现引擎</span><br><span class="line">      ie: 0,</span><br><span class="line">      gecko:0,</span><br><span class="line">      webkit: 0,</span><br><span class="line">      khtml:0,</span><br><span class="line">      opera:0,</span><br><span class="line">      //其他版本号</span><br><span class="line">      ver: null</span><br><span class="line">  &#125;;</span><br><span class="line">  var browser = &#123;</span><br><span class="line">      // 浏览器</span><br><span class="line">      ie: 0,</span><br><span class="line">      firefox:0,</span><br><span class="line">      safari:0,</span><br><span class="line">      konq:0,</span><br><span class="line">      opera:0,</span><br><span class="line">      chrome:0,</span><br><span class="line">      // 其他的版本</span><br><span class="line">      ver: null</span><br><span class="line">  &#125;;</span><br><span class="line">  var system = &#123;</span><br><span class="line">      win: false,</span><br><span class="line">      mac: false,</span><br><span class="line">      xll: false,</span><br><span class="line">      // 移动设备</span><br><span class="line">      iphone: false,</span><br><span class="line">      ipod: false,</span><br><span class="line">      ipad: false,</span><br><span class="line">      ios: false,</span><br><span class="line">      android:false</span><br><span class="line">      // 游戏系统</span><br><span class="line">      wii: false,</span><br><span class="line">      ps: false</span><br><span class="line">   &#125;;</span><br><span class="line"></span><br><span class="line">   var ua = navigator.userAgent.toLowerCase();</span><br><span class="line">   if(ua.match(/opr\/([\d\.]+)/) || window.opera) &#123;</span><br><span class="line">       var result = ua.match(/opr\/([\d\.]+)/);</span><br><span class="line">       engine.ver = browser.ver = result[1];</span><br><span class="line">       engine.opera = browser.opera = parseFloat(engine.ver);</span><br><span class="line">       if(window.opera) &#123;</span><br><span class="line">            engine.ver = browser.ver = window.opera.version();</span><br><span class="line">            engine.opera = browser.opera = parseFloat(engine.ver);</span><br><span class="line">        &#125;</span><br><span class="line">   &#125; else if(/applewebkit\/(\S+)/.test(ua)) &#123;</span><br><span class="line">       engine.ver = RegExp[&quot;$1&quot;];</span><br><span class="line">       engine.webkit = parseFloat(engine.ver);</span><br><span class="line">       // 确定是chrome还是safari</span><br><span class="line">       /*</span><br><span class="line">        * chrome用户代理字符串</span><br><span class="line">        * Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko)</span><br><span class="line">        * Chrome/42.0.2311.152 Safari/537.36</span><br><span class="line">        */</span><br><span class="line">        if(/chrome\/(\S+)/.test(ua)) &#123;</span><br><span class="line">             browser.ver = RegExp[&quot;$1&quot;];</span><br><span class="line">             browser.chrome = parseFloat(browser.ver);</span><br><span class="line">        &#125;else if(/version\/(\S+)/.test(ua)) &#123;</span><br><span class="line">             /*</span><br><span class="line">              * safari用户代理字符串</span><br><span class="line">              * Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/534.57.2 (KHTML, like Gecko)</span><br><span class="line">              * Version/5.1.7 Safari/534.57.2</span><br><span class="line">              */</span><br><span class="line">             browser.ver = RegExp[&quot;$1&quot;];</span><br><span class="line">             browser.safari = parseFloat(browser.ver);</span><br><span class="line">        &#125;else &#123;</span><br><span class="line">             //近似地确定版本号</span><br><span class="line">             var safariVersion = 1;</span><br><span class="line">             if (engine.webkit &lt; 100)&#123;</span><br><span class="line">                 safariVersion = 1;</span><br><span class="line">             &#125; else if (engine.webkit &lt; 312)&#123;</span><br><span class="line">                 safariVersion = 1.2;</span><br><span class="line">             &#125; else if (engine.webkit &lt; 412)&#123;</span><br><span class="line">                 safariVersion = 1.3;</span><br><span class="line">             &#125; else &#123;</span><br><span class="line">                 safariVersion = 2;</span><br><span class="line">             &#125;</span><br><span class="line">             browser.safari = browser.ver = safariVersion;</span><br><span class="line">         &#125;</span><br><span class="line">   &#125;else if (/khtml\/(\S+)/.test(ua) || /konqueror\/([^;]+)/.test(ua))&#123;</span><br><span class="line">         engine.ver = browser.ver = RegExp[&quot;$1&quot;];</span><br><span class="line">         engine.khtml = browser.konq =  parseFloat(engine.ver);</span><br><span class="line"></span><br><span class="line">   &#125;else if(/rv:([^\)]+)\) gecko\/\d&#123;8&#125;/.test(ua))&#123;</span><br><span class="line">         engine.ver = RegExp[&quot;$1&quot;];</span><br><span class="line">         engine.gecko = parseFloat(engine.ver);</span><br><span class="line">         /*</span><br><span class="line">          * firefox的用户代理的字符串</span><br><span class="line">          * Mozilla/5.0 (Windows NT 6.1; WOW64; rv:38.0)</span><br><span class="line">          * Gecko/20100101 Firefox/38.0</span><br><span class="line">          */</span><br><span class="line">         // 确定是不是firefox</span><br><span class="line">         if(/firefox\/(\S+)/.test(ua)) &#123;</span><br><span class="line">             browser.ver = RegExp[&quot;$1&quot;];</span><br><span class="line">             browser.firefox = parseFloat(browser.ver);</span><br><span class="line">         &#125;</span><br><span class="line">    &#125;else if (/msie ([^;]+)/.test(ua) || &quot;ActiveXObject&quot; in window)&#123;</span><br><span class="line">         if(&quot;ActiveXObject&quot; in window) &#123;</span><br><span class="line">            if(/msie ([^;]+)/.test(ua)) &#123;</span><br><span class="line">               engine.ver = browser.ver = RegExp[&quot;$1&quot;];</span><br><span class="line">               engine.ie = browser.ie = parseFloat(engine.ver);</span><br><span class="line">            &#125;else &#123;</span><br><span class="line">               if(/rv:([^\)]+)\)/.test(ua)) &#123;</span><br><span class="line">                   engine.ver = browser.ver = RegExp[&quot;$1&quot;];</span><br><span class="line">                   engine.ie = browser.ie = parseFloat(engine.ver);</span><br><span class="line">               &#125;</span><br><span class="line">            &#125;</span><br><span class="line">         &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    //检测浏览器</span><br><span class="line">    browser.ie = engine.id;</span><br><span class="line">    browser.opera = engine.opera;</span><br><span class="line">    // 检测平台</span><br><span class="line">    var platform = navigator.platform;</span><br><span class="line">    system.win = platform.indexOf(&quot;Win&quot;) == 0;</span><br><span class="line">    system.mac = platform.indexOf(&quot;Mac&quot;) == 0;</span><br><span class="line">    system.x11 = (platform.indexOf(&quot;X11&quot;) == 0) || (platform.indexOf(&quot;Linux&quot;) == 0);</span><br><span class="line"></span><br><span class="line">    // 移动设备</span><br><span class="line">    system.iphone = ua.indexOf(&quot;iphone&quot;) &gt; -1;</span><br><span class="line">    system.ipod = ua.indexOf(&quot;ipod&quot;) &gt; -1;</span><br><span class="line">    system.ipad = ua.indexOf(&quot;ipad&quot;) &gt; -1;</span><br><span class="line">    //检测iOS 版本</span><br><span class="line">    if (system.mac &amp;&amp; ua.indexOf(&quot;mobile&quot;) &gt; -1)&#123;</span><br><span class="line">         if (/cpu (?:iphone )?os (\d+_\d+)/.test(ua))&#123;</span><br><span class="line">             system.ios = parseFloat(RegExp.$1.replace(&quot;_&quot;, &quot;.&quot;));</span><br><span class="line">         &#125; else &#123;</span><br><span class="line">             system.ios = 2; //不能真正检测出来，所以只能猜测</span><br><span class="line">         &#125;</span><br><span class="line">     &#125;</span><br><span class="line">     //检测Android 版本</span><br><span class="line">     if (/android (\d+\.\d+)/.test(ua))&#123;</span><br><span class="line">         system.android = parseFloat(RegExp.$1);</span><br><span class="line">     &#125;</span><br><span class="line">     system.wii = ua.indexOf(&apos;wii&apos;) &gt; -1;</span><br><span class="line">     system.ps = /playstation/i.test(ua);</span><br><span class="line"></span><br><span class="line">     return &#123;</span><br><span class="line">       engine: engine,</span><br><span class="line">       browser: browser,</span><br><span class="line">       system: system,</span><br><span class="line">     &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://blog.hellolc.com/2017/07/13/客户端检测/" data-id="cl7e5jfgw002qdo5watlhwh8x" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javaScript高级程序设计笔记/">javaScript高级程序设计笔记</a></li></ul>

    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    <a class="extend prev" rel="prev" href="/page/3/">&laquo; __('prev')</a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/">5</a><a class="page-number" href="/page/6/">6</a><a class="extend next" rel="next" href="/page/5/">__('next') &raquo;</a>
  </nav>
</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Core-HTML5-Canvas/">Core HTML5 Canvas</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JAVA/">JAVA</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JavaScript/">JavaScript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JavaScript-Web-Applications/">JavaScript Web Applications</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JavaScript设计模式与开发实践/">JavaScript设计模式与开发实践</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Jquery/">Jquery</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Pro-Git/">Pro Git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ReactNative/">ReactNative</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Vim实用技巧/">Vim实用技巧</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/You-Don-t-Know-JS/">You Don't Know JS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/css/">css</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/html5/">html5</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/javaScript高级程序设计笔记/">javaScript高级程序设计笔记</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/kafka/">kafka</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux系统编程/">linux系统编程</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tools/">tools</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/数据结构与算法/">数据结构与算法</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/深入React技术栈/">深入React技术栈</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/深入浅出Node-js/">深入浅出Node.js</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/深入理解计算机系统/">深入理解计算机系统</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/算法/">算法</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/设计模式/">设计模式</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/Core-HTML5-Canvas/" style="font-size: 12px;">Core HTML5 Canvas</a> <a href="/tags/JAVA/" style="font-size: 10px;">JAVA</a> <a href="/tags/JavaScript/" style="font-size: 18px;">JavaScript</a> <a href="/tags/JavaScript-Web-Applications/" style="font-size: 12px;">JavaScript Web Applications</a> <a href="/tags/JavaScript设计模式与开发实践/" style="font-size: 10px;">JavaScript设计模式与开发实践</a> <a href="/tags/Jquery/" style="font-size: 10px;">Jquery</a> <a href="/tags/Pro-Git/" style="font-size: 10px;">Pro Git</a> <a href="/tags/ReactNative/" style="font-size: 12px;">ReactNative</a> <a href="/tags/Vim实用技巧/" style="font-size: 10px;">Vim实用技巧</a> <a href="/tags/You-Don-t-Know-JS/" style="font-size: 16px;">You Don't Know JS</a> <a href="/tags/css/" style="font-size: 12px;">css</a> <a href="/tags/html5/" style="font-size: 10px;">html5</a> <a href="/tags/javaScript高级程序设计笔记/" style="font-size: 20px;">javaScript高级程序设计笔记</a> <a href="/tags/kafka/" style="font-size: 10px;">kafka</a> <a href="/tags/linux系统编程/" style="font-size: 10px;">linux系统编程</a> <a href="/tags/tools/" style="font-size: 10px;">tools</a> <a href="/tags/数据结构与算法/" style="font-size: 10px;">数据结构与算法</a> <a href="/tags/深入React技术栈/" style="font-size: 14px;">深入React技术栈</a> <a href="/tags/深入浅出Node-js/" style="font-size: 10px;">深入浅出Node.js</a> <a href="/tags/深入理解计算机系统/" style="font-size: 10px;">深入理解计算机系统</a> <a href="/tags/算法/" style="font-size: 12px;">算法</a> <a href="/tags/设计模式/" style="font-size: 10px;">设计模式</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/02/">February 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/10/">October 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">May 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">April 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">February 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">January 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">December 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">October 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">September 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">August 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">July 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">June 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">March 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/02/">February 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">January 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/12/">December 2016</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2022/02/20/KafkaController的生命周期/">KafkaController的生命周期</a>
          </li>
        
          <li>
            <a href="/2021/10/20/FastJSON Key Hash冲突问题/">FastJSON Key Hash冲突问题</a>
          </li>
        
          <li>
            <a href="/2018/05/18/设计模式/">设计模式</a>
          </li>
        
          <li>
            <a href="/2018/05/09/数据结构/">数据结构与算法</a>
          </li>
        
          <li>
            <a href="/2018/05/06/Drawing/">Drawing</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2022 lichen<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>